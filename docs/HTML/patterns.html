<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="Usage Patterns - PMDco Documentation" name="description" />
    <title>Usage Patterns | PMDco Documentation</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap"
        rel="stylesheet" />
    <style>
        /* =====================================================
       PMDco DOCUMENTATION STYLES
       =====================================================
       
       OVERVIEW:
       This stylesheet controls the entire documentation appearance including:
       - CSS Variables (lines ~15-100): Color themes, spacing, typography
       - Theme switching (lines ~80-180): Light/dark mode overrides
       - Layout components: Header, Sidebar, Main content, TOC
       - Mermaid graph containers: Interactive diagram styling
       - Edge/Arrow colors: Theme-dependent stroke colors
       - Edge labels: Theme-dependent text colors (black in light, white in dark)
       
       KEY PATTERNS:
       - Use CSS variables (--color-*) for consistent theming
       - body:not(.theme-dark) class toggles light mode styles
       - Graph edges use !important to override Mermaid defaults
       
       CRITICAL SECTIONS:
       - Lines ~125-180: Edge and arrow color overrides for light/dark modes
       - Lines ~825-875: Edge label color overrides for light/dark modes
       
       ===================================================== */

        /* === CSS VARIABLES - Core design tokens === */
        :root {
            --color-primary: #00a0e3;
            --color-primary-dark: #0077b3;
            --color-primary-light: #33b5eb;
            --color-accent: #7dd3fc;
            --color-surface: rgba(255, 255, 255, 0.92);
            --color-bg-primary: #f7f9fc;
            --color-bg-secondary: #ffffff;
            --color-bg-tertiary: #edf2f7;
            --color-bg-card: #ffffff;
            --color-bg-hover: rgba(0, 160, 227, 0.08);
            --color-text-primary: #0f172a;
            --color-text-secondary: #1f2937;
            --color-text-muted: #475569;
            --color-border: rgba(15, 23, 42, 0.1);
            --color-border-hover: rgba(0, 160, 227, 0.5);
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-error: #ef4444;
            --color-info: #3b82f6;
            --color-code-bg: #f3f4f6;
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-family-mono: 'JetBrains Mono', monospace;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --font-size-4xl: 2.25rem;
            --radius-sm: 0.25rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-full: 9999px;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 20px rgba(0, 160, 227, 0.3);
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --sidebar-width: 280px;
            --header-height: 64px;
            --toc-width: 240px;
            --z-sticky: 200;
            --z-modal: 300;
            --z-tooltip: 400;

            /* Mermaid graph variables */
            --dim: 0.12;
            --pop-header: linear-gradient(135deg, #1e3a5f 0%, #2d4a6f 100%);
            --pop-header-text: #ffffff;
            --card-bg: #f1f5f9;
            --card-border: #cbd5e1;
            --card-hover: #e2e8f0;
            --pred-color: #475569;
            --val-color: #1e293b;
        }

        body.theme-dark {
            --color-bg-primary: #0a1628;
            --color-bg-secondary: #0d1f35;
            --color-bg-tertiary: #132743;
            --color-bg-card: rgba(19, 39, 67, 0.8);
            --color-bg-hover: rgba(0, 160, 227, 0.1);
            --color-surface: rgba(10, 22, 40, 0.95);
            --color-text-primary: #ffffff;
            --color-text-secondary: #94a3b8;
            --color-text-muted: #64748b;
            --color-border: rgba(148, 163, 184, 0.2);
            --color-code-bg: #1e293b;
            --card-bg: #0f172a;
            --card-border: #475569;
            --card-hover: #334155;
            --pred-color: #94a3b8;
            --val-color: #e2e8f0;
        }

        /* ===========================================
       LIGHT MODE GRAPH CONTAINER OVERRIDES
       Pure white backgrounds per user preference.
       Ensures clean, professional appearance for diagrams.
       =========================================== */
        body:not(.theme-dark) .mermaid-graph-container {
            background: #ffffff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        body:not(.theme-dark) .graph-header {
            background: #ffffff;
        }

        body:not(.theme-dark) .graph-viewport {
            background: #ffffff;
        }

        body:not(.theme-dark) .graph-legend {
            background: #ffffff;
        }

        body:not(.theme-dark) .zoom-controls {
            background: #ffffff;
        }

        body:not(.theme-dark) .zoom-btn {
            background: #f8fafc;
        }

        /* ===========================================
       EDGE AND ARROW COLOR OVERRIDES
       =========================================== 
       
       CRITICAL: These styles override Mermaid's default edge colors
       to ensure proper visibility in both light and dark themes.
       
       Dark mode (default): White edges (#ffffff) on dark backgrounds
       Light mode: Black edges (#1e293b) on white backgrounds
       
       The !important flag is necessary to override Mermaid's inline styles.
       
       Components affected:
       - path.flowchart-link: Main edge lines connecting nodes
       - .edgePath path: Alternative edge path selector
       - marker path: Arrowheads at edge endpoints
       
       Both .graph-wrapper (inline view) and .fullscreen-wrapper 
       (fullscreen modal) need separate rules.
       =========================================== */

        /* DARK MODE EDGES (default) - White for visibility on dark backgrounds */
        .graph-wrapper svg path.flowchart-link {
            stroke: #ffffff !important;
        }

        .graph-wrapper svg .edgePath path {
            stroke: #ffffff !important;
        }

        /* Dark mode arrowheads */
        .graph-wrapper svg marker path {
            fill: #ffffff !important;
            stroke: #ffffff !important;
        }

        /* Fullscreen modal - dark mode edges */
        .fullscreen-wrapper svg path.flowchart-link {
            stroke: #ffffff !important;
        }

        .fullscreen-wrapper svg .edgePath path {
            stroke: #ffffff !important;
        }

        .fullscreen-wrapper svg marker path {
            fill: #ffffff !important;
            stroke: #ffffff !important;
        }

        /* LIGHT MODE EDGES - Black (#1e293b) for visibility on white backgrounds */
        body:not(.theme-dark) .graph-wrapper svg path.flowchart-link {
            stroke: #1e293b !important;
        }

        body:not(.theme-dark) .graph-wrapper svg .edgePath path {
            stroke: #1e293b !important;
        }

        /* Light mode arrowheads */
        body:not(.theme-dark) .graph-wrapper svg marker path {
            fill: #1e293b !important;
            stroke: #1e293b !important;
        }

        /* Fullscreen modal - light mode edges */
        body:not(.theme-dark) .fullscreen-wrapper svg path.flowchart-link {
            stroke: #1e293b !important;
        }

        body:not(.theme-dark) .fullscreen-wrapper svg .edgePath path {
            stroke: #1e293b !important;
        }

        body:not(.theme-dark) .fullscreen-wrapper svg marker path {
            fill: #1e293b !important;
            stroke: #1e293b !important;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            font-size: var(--font-size-base);
            line-height: 1.5;
            color: var(--color-text-primary);
            background: var(--color-bg-primary);
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at 20% 50%, rgba(0, 160, 227, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 160, 227, 0.05) 0%, transparent 40%);
            pointer-events: none;
            z-index: -1;
        }

        /* Typography */
        h1,
        h2,
        h3,
        h4 {
            font-weight: 600;
            line-height: 1.25;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-md);
        }

        h1 {
            font-size: var(--font-size-4xl);
            font-weight: 700;
            background: linear-gradient(135deg, var(--color-text-primary), var(--color-primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: var(--font-size-2xl);
            margin-top: var(--spacing-2xl);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--color-border);
        }

        h3 {
            font-size: var(--font-size-xl);
            margin-top: var(--spacing-xl);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text-secondary);
        }

        a {
            color: var(--color-primary);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        a:hover {
            color: var(--color-primary-light);
            text-decoration: underline;
        }

        strong {
            font-weight: 600;
            color: var(--color-text-primary);
        }

        ul,
        ol {
            margin-bottom: var(--spacing-md);
            padding-left: var(--spacing-xl);
            color: var(--color-text-secondary);
        }

        code:not(pre code) {
            padding: 2px 6px;
            font-size: 0.9em;
            font-family: var(--font-family-mono);
            color: var(--color-primary-light);
            background: var(--color-code-bg);
            border-radius: var(--radius-sm);
        }

        pre {
            margin: var(--spacing-lg) 0;
            padding: var(--spacing-lg);
            background: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            overflow-x: auto;
        }

        pre code {
            font-family: var(--font-family-mono);
            font-size: var(--font-size-sm);
            color: #e2e8f0;
        }

        body:not(.theme-dark) pre code {
            color: #1e293b;
        }

        body:not(.theme-dark) pre {
            background: #f8fafc;
            border-color: #e2e8f0;
        }

        hr {
            border: none;
            border-top: 1px solid var(--color-border);
            margin: var(--spacing-xl) 0;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: var(--color-surface);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--color-border);
            z-index: var(--z-sticky);
            display: flex;
            align-items: center;
            padding: 0 var(--spacing-lg);
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: var(--font-size-lg);
            font-weight: 700;
            color: var(--color-text-primary);
        }

        .header-nav {
            display: flex;
            gap: var(--spacing-xl);
            margin-left: auto;
        }

        .header-nav a {
            font-size: var(--font-size-sm);
            font-weight: 500;
            color: var(--color-text-secondary);
        }

        .header-nav a:hover {
            color: var(--color-text-primary);
            text-decoration: none;
        }

        .theme-toggle {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            margin-left: var(--spacing-md);
            padding: 8px 12px;
            border-radius: var(--radius-full);
            border: 1px solid var(--color-border);
            background: var(--color-bg-secondary);
            color: var(--color-text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .theme-toggle:hover {
            color: var(--color-text-primary);
            border-color: var(--color-border-hover);
        }

        .theme-toggle svg {
            width: 18px;
            height: 18px;
        }

        .theme-label {
            font-size: var(--font-size-sm);
            font-weight: 500;
        }

        .mobile-menu-btn {
            display: none;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: transparent;
            border: none;
            color: var(--color-text-primary);
            cursor: pointer;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            bottom: 0;
            width: var(--sidebar-width);
            background: var(--color-bg-secondary);
            border-right: 1px solid var(--color-border);
            overflow-y: auto;
            padding: var(--spacing-lg);
            z-index: var(--z-sticky);
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--color-border);
            border-radius: var(--radius-full);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: calc(var(--z-modal) - 1);
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* Navigation */
        .nav-section {
            margin-bottom: var(--spacing-xl);
        }

        .nav-section-title {
            font-size: var(--font-size-xs);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--color-text-muted);
            margin-bottom: var(--spacing-sm);
        }

        .nav-list {
            list-style: none;
            padding-left: 0;
        }

        .nav-list li {
            margin-bottom: 2px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            border-radius: var(--radius-md);
            transition: all var(--transition-fast);
        }

        .nav-link:hover {
            color: var(--color-text-primary);
            background: var(--color-bg-hover);
            text-decoration: none;
        }

        .nav-link.active {
            color: var(--color-primary);
            background: rgba(0, 160, 227, 0.15);
            font-weight: 500;
        }

        .nav-link svg {
            width: 18px;
            height: 18px;
            opacity: 0.7;
        }

        /* Search */
        .search-container {
            position: relative;
            margin-bottom: var(--spacing-xl);
        }

        .search-input {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            padding-left: 40px;
            font-size: var(--font-size-sm);
            color: var(--color-text-primary);
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            outline: none;
        }

        .search-input:focus {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(0, 160, 227, 0.2);
        }

        .search-icon {
            position: absolute;
            left: var(--spacing-md);
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            color: var(--color-text-muted);
        }

        .search-shortcut {
            position: absolute;
            right: var(--spacing-sm);
            top: 50%;
            transform: translateY(-50%);
            padding: 2px 6px;
            font-size: var(--font-size-xs);
            font-family: var(--font-family-mono);
            color: var(--color-text-muted);
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
        }

        /* Search Modal */
        .search-modal {
            position: fixed;
            inset: 0;
            z-index: var(--z-modal);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: none;
            align-items: flex-start;
            justify-content: center;
            padding-top: 15vh;
        }

        .search-modal.active {
            display: flex;
        }

        .search-modal-content {
            width: 100%;
            max-width: 640px;
            max-height: 70vh;
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.6);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .search-modal-header {
            display: flex;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--color-border);
        }

        .search-modal-input {
            flex: 1;
            padding: var(--spacing-sm);
            font-size: var(--font-size-lg);
            color: var(--color-text-primary);
            background: transparent;
            border: none;
            outline: none;
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
            padding: var(--spacing-sm);
        }

        .search-result-item {
            display: block;
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            transition: background var(--transition-fast);
        }

        .search-result-item:hover,
        .search-result-item.selected {
            background: var(--color-bg-hover);
            text-decoration: none;
        }

        .search-result-title {
            font-weight: 500;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .search-result-path {
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
        }

        .search-no-results {
            padding: var(--spacing-xl);
            text-align: center;
            color: var(--color-text-muted);
        }

        .search-section-label {
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-xs);
            font-weight: 600;
            color: var(--color-text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--color-border);
            background: var(--color-bg-tertiary);
        }

        .search-result-title mark {
            background: rgba(0, 160, 227, 0.3);
            color: var(--color-primary-light);
            padding: 0 2px;
            border-radius: 2px;
        }

        .search-footer {
            display: flex;
            justify-content: center;
            gap: var(--spacing-lg);
            padding: var(--spacing-sm) var(--spacing-lg);
            border-top: 1px solid var(--color-border);
            font-size: var(--font-size-xs);
            color: var(--color-text-muted);
        }

        .search-footer kbd {
            padding: 2px 6px;
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            font-family: var(--font-family-mono);
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            padding: var(--spacing-2xl);
            flex: 1;
            min-height: calc(100vh - var(--header-height));
        }

        .content-wrapper {
            max-width: 1000px;
            margin: 0 auto;
        }

        .breadcrumbs {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
            font-size: var(--font-size-sm);
        }

        .breadcrumbs a {
            color: var(--color-text-muted);
        }

        .breadcrumbs .current {
            color: var(--color-text-secondary);
        }

        /* TOC */
        .toc {
            position: fixed;
            top: calc(var(--header-height) + var(--spacing-2xl));
            right: var(--spacing-xl);
            width: var(--toc-width);
            max-height: calc(100vh - var(--header-height) - 4rem);
            overflow-y: auto;
            padding: var(--spacing-md);
            background: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(8px);
        }

        .toc-title {
            font-size: var(--font-size-xs);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--color-text-muted);
            margin-bottom: var(--spacing-md);
        }

        .toc-list {
            list-style: none;
            padding-left: 0;
        }

        .toc-list a {
            display: block;
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-left: 2px solid transparent;
            transition: all var(--transition-fast);
        }

        .toc-list a:hover,
        .toc-list a.active {
            color: var(--color-primary);
            border-left-color: var(--color-primary);
            background: var(--color-bg-hover);
            text-decoration: none;
        }

        .toc-list .toc-h3 {
            padding-left: var(--spacing-lg);
        }

        /* Page Nav */
        .page-nav {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-lg);
            margin-top: var(--spacing-2xl);
            padding-top: var(--spacing-xl);
            border-top: 1px solid var(--color-border);
        }

        .page-nav-link {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            padding: var(--spacing-lg);
            background: var(--color-bg-card);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast);
        }

        .page-nav-link:hover {
            border-color: var(--color-primary);
            text-decoration: none;
            box-shadow: var(--shadow-glow);
        }

        .page-nav-link.next {
            text-align: right;
        }

        .page-nav-label {
            font-size: var(--font-size-xs);
            font-weight: 500;
            color: var(--color-text-muted);
            text-transform: uppercase;
        }

        .page-nav-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--color-primary);
        }

        /* Footer */
        .footer {
            margin-top: var(--spacing-2xl);
            padding: var(--spacing-xl) 0;
            border-top: 1px solid var(--color-border);
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
        }

        .footer-links a {
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
        }

        .footer-copyright {
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
        }

        /* === MERMAID GRAPH CONTAINER === */
        .mermaid-graph-container {
            position: relative;
            margin: var(--spacing-xl) 0;
            background: linear-gradient(135deg, var(--color-bg-card) 0%, rgba(13, 31, 53, 0.95) 100%);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .graph-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-sm) var(--spacing-lg);
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.03) 0%, transparent 100%);
            border-bottom: 1px solid var(--color-border);
            flex-wrap: wrap;
            gap: var(--spacing-sm);
        }

        .graph-title {
            font-size: var(--font-size-sm);
            font-weight: 600;
            color: var(--color-text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .graph-title::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--color-primary);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--color-primary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .graph-controls {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .graph-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 36px;
            height: 32px;
            padding: 0 10px;
            font-size: var(--font-size-sm);
            font-weight: 500;
            color: var(--color-text-secondary);
            background: linear-gradient(180deg, var(--color-bg-tertiary) 0%, var(--color-bg-secondary) 100%);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .graph-btn:hover {
            color: var(--color-text-primary);
            border-color: var(--color-primary);
            background: var(--color-bg-hover);
            box-shadow: 0 0 12px rgba(0, 160, 227, 0.2);
        }

        .graph-viewport {
            position: relative;
            min-height: 450px;
            max-height: 600px;
            overflow: hidden;
            background: radial-gradient(ellipse at center, rgba(0, 160, 227, 0.03) 0%, transparent 70%);
            cursor: grab;
        }

        .graph-viewport:active {
            cursor: grabbing;
        }

        .graph-wrapper {
            transform-origin: 0 0;
            transition: transform 0.05s;
            will-change: transform;
            display: flex;
            align-items: flex-start;
            justify-content: flex-start;
            min-width: 100%;
            min-height: 100%;
        }

        .graph-wrapper svg {
            max-width: none;
            display: block;
            overflow: visible;
            min-width: 100px;
            min-height: 100px;
        }

        .mermaid-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 100%;
            min-height: 100%;
        }

        .mermaid-diagram svg {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Mermaid node styles */
        .graph-wrapper svg g.node {
            cursor: pointer;
            transition: all 0.2s;
        }

        .graph-wrapper svg g.node:hover {
            filter: brightness(1.1);
        }

        .graph-wrapper svg g.node.selected rect,
        .graph-wrapper svg g.node.selected polygon,
        .graph-wrapper svg g.node.selected ellipse {
            stroke-width: 3px !important;
            filter: drop-shadow(0 0 8px var(--color-primary));
        }

        .graph-wrapper svg g.node.dim {
            opacity: var(--dim) !important;
        }

        .graph-wrapper svg g.node.hovered rect,
        .graph-wrapper svg g.node.hovered polygon,
        .graph-wrapper svg g.node.hovered ellipse {
            stroke: var(--color-primary) !important;
            stroke-width: 3px !important;
            filter: drop-shadow(0 0 10px var(--color-primary));
        }

        .graph-wrapper svg g.node.ancestor rect,
        .graph-wrapper svg g.node.ancestor polygon,
        .graph-wrapper svg g.node.ancestor ellipse {
            stroke: var(--color-primary) !important;
            stroke-width: 2.5px !important;
            stroke-dasharray: 6 4;
        }

        /* ===========================================
       EDGE LABEL STYLES
       Controls the text color of relationship labels on graph edges.
       - Dark mode: white labels for visibility on dark backgrounds
       - Light mode: black labels for visibility on white backgrounds
       =========================================== */

        /* Dark mode edge labels - white text (default) */
        .graph-wrapper svg g.edgeLabel text,
        .graph-wrapper svg g.edgeLabel tspan {
            fill: #ffffff !important;
        }

        .fullscreen-wrapper svg g.edgeLabel text,
        .fullscreen-wrapper svg g.edgeLabel tspan {
            fill: #ffffff !important;
        }

        /* Light mode edge labels - black text */
        body:not(.theme-dark) .graph-wrapper svg g.edgeLabel text,
        body:not(.theme-dark) .graph-wrapper svg g.edgeLabel tspan {
            fill: #1e293b !important;
        }

        body:not(.theme-dark) .fullscreen-wrapper svg g.edgeLabel text,
        body:not(.theme-dark) .fullscreen-wrapper svg g.edgeLabel tspan {
            fill: #1e293b !important;
        }

        /* Edge dimming for focus/highlight interactions */
        .graph-wrapper svg g.edgePath.dim {
            opacity: var(--dim) !important;
        }

        .graph-wrapper svg g.edgeLabel.dim {
            opacity: var(--dim) !important;
        }

        .graph-wrapper svg g.edgePath.dim path {
            opacity: var(--dim) !important;
        }

        /* Edge highlighting when connected nodes are selected */
        .graph-wrapper svg g.edgePath.highlight {
            opacity: 1 !important;
        }

        .graph-wrapper svg g.edgePath.highlight path {
            opacity: 1 !important;
        }

        .graph-wrapper svg g.edgeLabel.highlight {
            opacity: 1 !important;
        }

        .graph-wrapper svg g.edgePath.highlight path {
            stroke: var(--color-primary) !important;
            stroke-width: 2.5px !important;
        }

        .graph-wrapper svg g.edgeLabel.highlight text,
        .graph-wrapper svg g.edgeLabel.highlight tspan {
            fill: var(--color-primary) !important;
            font-weight: 700;
        }

        .graph-wrapper svg g.edgePath.typeEdge path {
            stroke-dasharray: 1.2 6 !important;
            stroke-linecap: round !important;
        }

        .graph-wrapper svg g.edgeLabel.typeEdge text,
        .graph-wrapper svg g.edgeLabel.typeEdge tspan {
            fill: var(--color-primary) !important;
        }

        .zoom-controls {
            position: absolute;
            top: 12px;
            right: 12px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            background: var(--color-bg-secondary);
            padding: 8px;
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--color-border);
            z-index: 100;
        }

        .zoom-btn {
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            color: var(--color-text-primary);
            user-select: none;
        }

        .zoom-btn:hover {
            background: var(--color-primary);
            color: white;
            transform: scale(1.05);
        }

        .zoom-level {
            text-align: center;
            font-size: var(--font-size-xs);
            color: var(--color-text-muted);
            padding: 4px;
            font-weight: 500;
        }

        /* Fullscreen modal */
        .fullscreen-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: var(--color-bg-primary);
            display: none;
            flex-direction: column;
        }

        .fullscreen-overlay.active {
            display: flex;
        }

        .fullscreen-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--color-bg-secondary);
            border-bottom: 1px solid var(--color-border);
        }

        .fullscreen-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            color: var(--color-text-primary);
        }

        .fullscreen-close {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: 8px 16px;
            font-size: var(--font-size-sm);
            font-weight: 500;
            color: var(--color-text-primary);
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .fullscreen-close:hover {
            background: var(--color-error);
            border-color: var(--color-error);
            color: white;
        }

        .fullscreen-viewport {
            flex: 1;
            position: relative;
            overflow: hidden;
            cursor: grab;
        }

        .fullscreen-viewport:active {
            cursor: grabbing;
        }

        .fullscreen-wrapper {
            transform-origin: 0 0;
            transition: transform 0.05s;
            will-change: transform;
            display: flex;
            align-items: flex-start;
            justify-content: flex-start;
            min-width: 100%;
            min-height: 100%;
        }

        .fullscreen-wrapper svg {
            max-width: none;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .fullscreen-zoom-controls {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            background: var(--color-bg-secondary);
            padding: 10px;
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--color-border);
            z-index: 100;
        }

        .fullscreen-zoom-btn {
            background: var(--color-bg-tertiary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            padding: 10px;
            cursor: pointer;
            font-size: 18px;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
            color: var(--color-text-primary);
            user-select: none;
        }

        .fullscreen-zoom-btn:hover {
            background: var(--color-primary);
            color: white;
            transform: scale(1.05);
        }

        .fullscreen-zoom-level {
            text-align: center;
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
            padding: 6px;
            font-weight: 500;
        }

        /* Popover */
        .graph-popover {
            position: fixed;
            z-index: 1000;
            display: none;
            min-width: 340px;
            max-width: 420px;
            max-height: 70vh;
            overflow-y: auto;
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            animation: popIn 0.2s;
        }

        @keyframes popIn {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .graph-popover.visible {
            display: block;
        }

        .pop-head {
            padding: 16px 20px;
            border-bottom: 1px solid var(--color-border);
            background: var(--pop-header);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            color: var(--pop-header-text);
            position: relative;
        }

        .pop-title {
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--pop-header-text);
        }

        .badge {
            display: inline-block;
            padding: 3px 8px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.25);
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: rgba(255, 255, 255, 0.95);
        }

        .pop-uri {
            font-size: 11px;
            opacity: 0.85;
            word-break: break-all;
            font-family: var(--font-family-mono);
            background: rgba(0, 0, 0, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
        }

        .pop-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .chip {
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .chip:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .close-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.05);
        }

        .pop-body {
            padding: 16px 20px;
        }

        .section {
            margin-bottom: 16px;
        }

        .section:last-child {
            margin-bottom: 0;
        }

        .sec-title {
            font-size: 11px;
            font-weight: 700;
            color: var(--color-text-muted);
            text-transform: uppercase;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: 0.5px;
        }

        .count {
            background: var(--color-primary);
            color: white;
            padding: 2px 7px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        .trips {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .trip {
            background: var(--card-bg);
            padding: 12px 14px;
            border-radius: 8px;
            border: 1px solid var(--card-border);
            transition: all 0.2s;
        }

        .trip:hover {
            border-color: var(--color-primary);
            background: var(--card-hover);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .pred {
            font-size: 10px;
            color: var(--pred-color);
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 4px;
            letter-spacing: 0.5px;
        }

        .val {
            font-size: 13px;
            color: var(--val-color);
            font-weight: 500;
            font-family: var(--font-family-mono);
        }

        .empty {
            text-align: center;
            padding: 20px;
            color: var(--color-text-muted);
            font-size: 12px;
            background: var(--card-bg);
            border-radius: 8px;
            border: 1px dashed var(--card-border);
        }

        /* Toast */
        .graph-toast {
            position: fixed;
            left: 50%;
            bottom: 18px;
            transform: translateX(-50%);
            background: rgba(15, 23, 42, 0.92);
            color: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 999px;
            padding: 10px 14px;
            font-size: 13px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
            display: none;
            z-index: 2000;
            backdrop-filter: blur(6px);
            max-width: min(520px, calc(100% - 24px));
            text-align: center;
        }

        body:not(.theme-dark) .graph-toast {
            background: rgba(255, 255, 255, 0.94);
            color: rgba(0, 0, 0, 0.86);
            border: 1px solid rgba(0, 0, 0, 0.10);
            box-shadow: 0 10px 26px rgba(0, 0, 0, 0.18);
        }

        /* Legend */
        .graph-legend {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-lg);
            background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.2) 100%);
            border-top: 1px solid var(--color-border);
        }

        .legend-item {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: var(--font-size-xs);
            font-weight: 500;
            color: var(--color-text-secondary);
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: var(--radius-full);
        }

        .legend-swatch {
            width: 14px;
            height: 14px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .swatch-class {
            background: linear-gradient(135deg, #b34dff 0%, #4a148c 100%);
        }

        .swatch-individual {
            background: linear-gradient(135deg, #e8f0ff 0%, #1e40af 100%);
        }

        .swatch-literal {
            background: linear-gradient(135deg, #fef3c7 0%, #d97706 100%);
        }

        .swatch-categorical {
            background: linear-gradient(135deg, #d1fae5 0%, #059669 100%);
        }

        .swatch-subclass {
            background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
        }

        .swatch-type {
            background: linear-gradient(135deg, #00a0e3 0%, #0077b3 100%);
        }

        .swatch-bfo {
            background: linear-gradient(135deg, #b34dff 0%, #7c3aed 100%);
        }

        .swatch-obi {
            background: linear-gradient(135deg, #a78bbc 0%, #7c5c8f 100%);
        }

        .swatch-pmd {
            background: linear-gradient(135deg, #6b7fa3 0%, #4a5568 100%);
        }

        .swatch-shacl {
            background: linear-gradient(135deg, #22d3ee 0%, #0891b2 100%);
        }

        .swatch-constraint {
            background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);
        }

        /* Responsive */
        @media (max-width: 1280px) {
            .toc {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform var(--transition-normal);
                z-index: var(--z-modal);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: var(--spacing-lg);
            }

            .header-nav {
                display: none;
            }

            .mobile-menu-btn {
                display: flex;
            }

            .page-nav {
                grid-template-columns: 1fr;
            }
        }

        /* Image Viewer */
        .image-viewer-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .image-viewer-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .image-viewer-container {
            position: relative;
            max-width: 95vw;
            max-height: 95vh;
            overflow: hidden;
            cursor: grab;
        }

        .image-viewer-container:active {
            cursor: grabbing;
        }

        .image-viewer-container img,
        .image-viewer-container svg {
            max-width: 100%;
            max-height: 90vh;
            transform-origin: center center;
            transition: transform 0.1s ease-out;
        }

        .image-viewer-controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            background: rgba(0, 0, 0, 0.8);
            padding: 12px 16px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .image-viewer-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.2s;
        }

        .image-viewer-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .image-viewer-close {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-viewer-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .viewable-image,
        .article-content svg {
            cursor: zoom-in;
            transition: transform 0.2s;
        }

        .viewable-image:hover,
        .article-content svg:hover {
            transform: scale(1.02);
        }

        body.no-scroll {
            overflow: hidden;
        }
    </style>
</head>

<body>
    <header class="header">
        <button aria-label="Toggle menu" class="mobile-menu-btn">
            <svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="24">
                <line x1="3" x2="21" y1="12" y2="12"></line>
                <line x1="3" x2="21" y1="6" y2="6"></line>
                <line x1="3" x2="21" y1="18" y2="18"></line>
            </svg>
        </button>
        <a class="header-logo" href="./intro.html">
            <img src="./Logo_MaterialDigital.svg" alt="MaterialDigital Logo" style="height: 36px; width: auto;">
            <span>PMDco <span style="color: var(--color-text-muted); font-weight: 400;">Docs</span></span>
        </a>
        <nav class="header-nav">
            <a href="https://materialdigital.de/" target="_blank">About</a>
            <a href="https://github.com/materialdigital/core-ontology" target="_blank">GitHub</a>
            <a href="https://materialdigital.github.io/core-ontology/3.0.0/" target="_blank">Widoco</a>
        </nav>
        <button aria-label="Toggle theme" class="theme-toggle">
            <span class="theme-icon">
                <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"></path>
                </svg>
            </span>
            <span class="theme-label">Dark</span>
        </button>
    </header>

    <div class="sidebar-overlay"></div>
    <aside class="sidebar">
        <div class="search-container">
            <svg class="search-icon" fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                width="18">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" x2="16.65" y1="21" y2="16.65"></line>
            </svg>
            <input class="search-input" placeholder="Search docs..." readonly="" type="text" />
            <span class="search-shortcut">Ctrl+K</span>
        </div>
        <nav class="nav-sections">
            <div class="nav-section">
                <h3 class="nav-section-title">Getting Started</h3>
                <ul class="nav-list">
                    <li><a class="nav-link" href="./index.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                            Home
                        </a></li>
                    <li><a class="nav-link" href="./intro.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M12 16v-4"></path>
                                <path d="M12 8h.01"></path>
                            </svg>
                            Introduction
                        </a></li>
                    <li><a class="nav-link" href="./introduction-to-ontologies.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                                <path d="M2 17l10 5 10-5"></path>
                                <path d="M2 12l10 5 10-5"></path>
                            </svg>
                            Ontologies Intro
                        </a></li>
                </ul>
            </div>
            <div class="nav-section">
                <h3 class="nav-section-title">Ontology Guide</h3>
                <ul class="nav-list">
                    <li><a class="nav-link" href="./ontology-structure.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <rect height="7" rx="1" width="7" x="3" y="3"></rect>
                                <rect height="7" rx="1" width="7" x="14" y="3"></rect>
                                <rect height="7" rx="1" width="7" x="14" y="14"></rect>
                                <rect height="7" rx="1" width="7" x="3" y="14"></rect>
                            </svg>
                            Structure
                        </a></li>
                    <li><a class="nav-link active" href="./patterns.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                            Usage Patterns
                        </a></li>
                    <li><a class="nav-link" href="./user-guide.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                            </svg>
                            User Guide
                        </a></li>
                    <li><a class="nav-link" href="./reused-ontologies.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <circle cx="18" cy="18" r="3"></circle>
                                <circle cx="6" cy="6" r="3"></circle>
                                <path d="M13 6h3a2 2 0 0 1 2 2v7"></path>
                                <path d="M11 18H8a2 2 0 0 1-2-2V9"></path>
                            </svg>
                            Reused Ontologies
                        </a></li>
                </ul>
            </div>
            <div class="nav-section">
                <h3 class="nav-section-title">Development</h3>
                <ul class="nav-list">
                    <li><a class="nav-link" href="./design-and-methodology.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M12 20h9"></path>
                                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                            </svg>
                            Design
                        </a></li>
                    <li><a class="nav-link" href="./ontology-formatting.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <polyline points="4 7 4 4 20 4 20 7"></polyline>
                                <line x1="9" x2="15" y1="20" y2="20"></line>
                                <line x1="12" x2="12" y1="4" y2="20"></line>
                            </svg>
                            Formatting
                        </a></li>
                    <li><a class="nav-link" href="./contributing.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <line x1="19" x2="19" y1="8" y2="14"></line>
                                <line x1="22" x2="16" y1="11" y2="11"></line>
                            </svg>
                            Contributing
                        </a></li>
                    <li><a class="nav-link" href="./migration.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M5 12h14"></path>
                                <path d="m12 5 7 7-7 7"></path>
                            </svg>
                            Migration
                        </a></li>
                </ul>
            </div>
            <div class="nav-section">
                <h3 class="nav-section-title">Resources</h3>
                <ul class="nav-list">
                    <li><a class="nav-link" href="./glossary-and-tools.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                            </svg>
                            Glossary
                        </a></li>
                    <li><a class="nav-link" href="./versions.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M12 8v4l3 3"></path>
                                <circle cx="12" cy="12" r="10"></circle>
                            </svg>
                            Versions
                        </a></li>
                    <li><a class="nav-link" href="./publications.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                            Publications
                        </a></li>
                    <li><a class="nav-link" href="./references.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                            </svg>
                            References
                        </a></li>
                </ul>
            </div>
            <div class="nav-section">
                <h3 class="nav-section-title">About</h3>
                <ul class="nav-list">
                    <li><a class="nav-link" href="./about-us.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            Who We Are
                        </a></li>
                    <li><a class="nav-link" href="./acknowledgements.html">
                            <svg fill="none" height="18" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                width="18">
                                <path
                                    d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z">
                                </path>
                            </svg>
                            Acknowledgements
                        </a></li>
                </ul>
            </div>
        </nav>
    </aside>

    <main class="main-content">
        <div class="content-wrapper">
            <nav class="breadcrumbs">
                <a href="./">Home</a><span>/</span><span class="current">Usage Patterns</span>
            </nav>

            <article class="content">
                <h1 id="usage-patterns">Usage Patterns</h1>
                <p>In ontology development and usage, <strong>usage patterns</strong> play a critical role in addressing
                    recurring modeling requirements. These patterns provide standardized, reusable semantic snippets
                    that facilitate consistent representation of relationships between instances and entities.
                    Furthermore, such patterns may be used to create SHACL shapes to include constraints in a knowledge
                    representation. By following usage patterns, ontology users and developers can ensure uniformity,
                    clarity, and reusability in their models.</p>
                <p>The sections below illustrate how to read and apply these patterns. Each pattern includes its
                    purpose, description, relevant properties, visualization, and example.</p>

                <!-- Pattern 1 -->
                <h2 id="pattern-1---temporal-region">Pattern 1 - Temporal Region</h2>
                <ul>
                    <li><strong>Purpose</strong>: Specifying the boundaries of a process on the time axis.</li>
                    <li><strong>Description</strong>: This graph describes a set of temporal relationships among
                        processes, temporal regions, and continuant entities. The graph models how different kinds of
                        entities relate to time and duration through their association with temporal regions and
                        instants.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-temporal-region">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 1 - Temporal Region</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-temporal-region">
                            <div class="mermaid-diagram" id="diagram-temporal-region"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-class"></span>Class (TBox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                        <span class="legend-item"><span
                                class="legend-swatch swatch-subclass"></span>rdfs:subClassOf</span>
                        <span class="legend-item"><span class="legend-swatch swatch-type"></span>rdf:type</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;https://www.example.org/&gt; .
@prefix process: &lt;http://purl.obolibrary.org/obo/BFO_0000015&gt; .
@prefix continuant: &lt;http://purl.obolibrary.org/obo/BFO_0000002&gt; .
@prefix temporal_region: &lt;http://purl.obolibrary.org/obo/BFO_0000008&gt; .
@prefix one-dimensional_temporal_region: &lt;http://purl.obolibrary.org/obo/BFO_0000038&gt; .
@prefix zero-dimensional_temporal_region: &lt;http://purl.obolibrary.org/obo/BFO_0000148&gt; .
@prefix occupies_temporal_region: &lt;http://purl.obolibrary.org/obo/BFO_0000199&gt; .
@prefix proper_temporal_part_of: &lt;http://purl.obolibrary.org/obo/BFO_0000136&gt; .
@prefix has_first_instant: &lt;http://purl.obolibrary.org/obo/BFO_0000222&gt; .
@prefix has_last_instant: &lt;http://purl.obolibrary.org/obo/BFO_0000224&gt; .
@prefix exists_at: &lt;http://purl.obolibrary.org/obo/BFO_0000108&gt; .

ex:process_1 a process: .
ex:process_2 a process: .
ex:period_1 a one-dimensional_temporal_region: .
ex:period_2 a one-dimensional_temporal_region: . 
ex:some_time a temporal_region: .
ex:object_1 a continuant: .
ex:start a zero-dimensional_temporal_region: .
ex:end a zero-dimensional_temporal_region: .

ex:process_1 occupies_temporal_region: ex:period_1 . 
ex:process_2 occupies_temporal_region: ex:period_2 .
ex:period_2 has_first_instant: ex:start . 
ex:period_2 has_last_instant: ex:end .
ex:period_1 proper_temporal_part_of: ex:period_2 .
ex:object_1 exists_at: ex:some_time .</code></pre>

                <p>(see folder <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/temporal%20region">patterns/temporal
                        region</a>)</p>

                <hr />

                <!-- Pattern 2 -->
                <h2 id="pattern-2---process-chain">Pattern 2 - Process Chain</h2>
                <ul>
                    <li><strong>Purpose</strong>: Represent processes, consisting of simultaneous and serial
                        subprocesses.</li>
                    <li><strong>Description</strong>: This graph describes a structured process chain that organizes
                        several interrelated process steps within a defined sequence.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-process-chain">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 2 - Process Chain</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-process-chain">
                            <div class="mermaid-diagram" id="diagram-process-chain"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-class"></span>Class (TBox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;https://www.example.org/&gt; .
@prefix process: &lt;http://purl.obolibrary.org/obo/BFO_0000015&gt; .
@prefix has_part: &lt;http://purl.obolibrary.org/obo/BFO_0000051&gt; .
@prefix precedes: &lt;http://purl.obolibrary.org/obo/BFO_0000063&gt; .
@prefix starts_with: &lt;http://purl.obolibrary.org/obo/RO_0002224&gt; .
@prefix ends_with: &lt;http://purl.obolibrary.org/obo/RO_0002230&gt; .
@prefix simultaneous_with: &lt;http://purl.obolibrary.org/obo/RO_0002082&gt; .

ex:process_parent a process: .
ex:process_step1 a process: .
ex:process_step2a a process: .
ex:process_step2b a process: .
ex:process_step3 a process: .

ex:process_parent starts_with: ex:process_step1 .
ex:process_parent ends_with: ex:process_step3 .
ex:process_parent has_part: ex:process_step1, ex:process_step2a, ex:process_step2b, ex:process_step3 .
ex:process_step1 precedes: ex:process_step2a, ex:process_step2b, ex:process_step3 .
ex:process_step2a precedes: ex:process_step3 .
ex:process_step2a simultaneous_with: ex:process_step2b .</code></pre>

                <p>(see folder <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/process%20chain">patterns/process
                        chain</a>)</p>

                <hr />

                <!-- Pattern 3 -->
                <h2 id="pattern-3---process-inputs-and-outputs">Pattern 3 - Process Inputs and Outputs</h2>
                <ul>
                    <li><strong>Purpose</strong>: Describes how to represent inputs and outputs for planned processes
                        typically involving material entities or information-bearing entities.</li>
                    <li><strong>Description</strong>: A planned process with possibility of multiple inputs and outputs.
                    </li>
                </ul>

                <div class="mermaid-graph-container" id="graph-process-io">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 3 - Process Inputs and Outputs</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-process-io">
                            <div class="mermaid-diagram" id="diagram-process-io"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-bfo"></span>BFO Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-obi"></span>OBI Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-pmd"></span>PMD Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;http://example.com/&gt; .
@prefix planned_process: &lt;http://purl.obolibrary.org/obo/OBI_0000011&gt; .
@prefix manufacturing_process: &lt;https://w3id.org/pmd/co/PMD_0000833&gt; .
@prefix coating: &lt;https://w3id.org/pmd/co/PMD_0000563&gt; .
@prefix has_specified_input: &lt;http://purl.obolibrary.org/obo/OBI_0000293&gt; .
@prefix has_specified_output: &lt;http://purl.obolibrary.org/obo/OBI_0000299&gt; .
@prefix object: &lt;http://purl.obolibrary.org/obo/BFO_0000030&gt; .

manufacturing_process: owl:subClassOf planned_process: .

ex:process1 a manufacturing_process: ;   
        has_specified_input: ex:object1 ;
        has_specified_output: ex:object2 . 

ex:process2 a coating:;  
        has_specified_input: ex:object2  ; 
        has_specified_output: ex:object3 . 

ex:object1 a object: .
ex:object2 a object: .
ex:object3 a object: .</code></pre>

                <p>(see folder <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/input%20and%20output%20of%20processes">patterns/input
                        and output of processes</a>)</p>

                <hr />

                <!-- Pattern 4 -->
                <h2 id="pattern-4---realizable-entities-role">Pattern 4 - Realizable Entities (Role)</h2>
                <ul>
                    <li><strong>Purpose</strong>: Represent characteristics of the objects, brought to existence by a
                        specific situation. E.g. a role, which is realized in a process.</li>
                    <li><strong>Description</strong>: This example describes how an object participates in a planned
                        experimental process by bearing a specific evaluant role.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-role-pattern">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 4 - Realizable Entities (Role)</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-role-pattern">
                            <div class="mermaid-diagram" id="diagram-role-pattern"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-class"></span>Class (TBox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;http://example.com/&gt; .
@prefix object: &lt;http://purl.obolibrary.org/obo/BFO_0000030&gt; .
@prefix evaluant_role: &lt;http://purl.obolibrary.org/obo/OBI_0000067&gt; .
@prefix has_role: &lt;http://purl.obolibrary.org/obo/RO_0000087&gt; .
@prefix has_realization: &lt;http://purl.obolibrary.org/obo/BFO_0000054&gt; .
@prefix fatigue_testing_process: &lt;https://w3id.org/pmd/co/PMD_0000638&gt; .
@prefix has_specified_input: &lt;http://purl.obolibrary.org/obo/OBI_0000293&gt; .
@prefix has_specified_output: &lt;http://purl.obolibrary.org/obo/OBI_0000299&gt; .
@prefix achieves_planned_objective: &lt;http://purl.obolibrary.org/obo/OBI_0000417&gt; .
@prefix is_about: &lt;http://purl.obolibrary.org/obo/IAO_0000136&gt;  .

ex:process_1 a fatigue_testing_process: .
ex:process_1 has_specified_input: ex:object_1 .
ex:process_1 achieves_planned_objective: ex:objective_1 .
ex:process_1 has_specified_output: ex:result_1 .

ex:objective_1 is_about: ex:object_1 .
ex:result_1 is_about: ex:object_1 .

ex:object_1 a object: .
ex:object_1 has_role: ex:role_1 .

ex:role_1 a evaluant_role: .
ex:role_1 has_realization: ex:process_1 .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/realizable%20entity%20(role)">patterns/realizable
                        entity (role)</a>)</p>

                <hr />

                <!-- Pattern 5 -->
                <h2 id="pattern-5---material-properties-qualities">Pattern 5 - Material Properties (Qualities)</h2>
                <ul>
                    <li><strong>Purpose</strong>: Represent materials, their qualities, and their behaviors at different
                        moments/periods of time.</li>
                    <li><strong>Example Use Case</strong>: This example models intrinsic material qualities (mass,
                        density), behavioral material properties (melting point realized through melting process), and
                        relational material qualities (mass proportion between materials).</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-material-properties">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 5 - Material Properties (Qualities)</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-material-properties">
                            <div class="mermaid-diagram" id="diagram-material-properties"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-bfo"></span>BFO Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-obi"></span>OBI Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-pmd"></span>PMD Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;https://www.example.org/&gt; .
@prefix object: &lt;http://purl.obolibrary.org/obo/BFO_0000030&gt; .
@prefix material: &lt;https://w3id.org/pmd/co/PMD_0000000&gt; .
@prefix quality: &lt;http://purl.obolibrary.org/obo/BFO_0000019&gt; .
@prefix mass: &lt;https://w3id.org/pmd/co/PMD_0020133&gt; .
@prefix density: &lt;https://w3id.org/pmd/co/PMD_0000597&gt; .
@prefix melting_point: &lt;https://w3id.org/pmd/co/PMD_0000851&gt; .
@prefix melting_process: &lt;https://w3id.org/pmd/co/PMD_0000053&gt; .
@prefix scalar_value_specification: &lt;http://purl.obolibrary.org/obo/OBI_0001931&gt; .
@prefix quality_of: &lt;http://purl.obolibrary.org/obo/RO_0000080&gt; .
@prefix has_realization: &lt;http://purl.obolibrary.org/obo/BFO_0000054&gt; .
@prefix specifies_value_of: &lt;http://purl.obolibrary.org/obo/OBI_0001927&gt; .
@prefix has_specified_numeric_value: &lt;http://purl.obolibrary.org/obo/OBI_0001937&gt; .
@prefix has_measurement_unit_label: &lt;http://purl.obolibrary.org/obo/IAO_0000039&gt; .

ex:metal_sheet a object: .
ex:mass_metal_sheet a mass: ; quality_of: ex:metal_sheet .
ex:svs_3_3_g a scalar_value_specification: ;
    has_specified_numeric_value: "3.3"^^xsd:float ;
    has_measurement_unit_label: gram: ;
    specifies_value_of: ex:mass_metal_sheet .

ex:steel_material a material: .
ex:density_steel a density: ; quality_of: ex:steel_material .
ex:melting_temperature_steel a melting_point: ;
    characteristic_of: ex:steel_material ;
    has_realization: ex:melting_process .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/material%20property%20(quality)">patterns/material
                        property (quality)</a>)</p>

                <hr />

                <!-- Pattern 6 -->
                <h2 id="pattern-6---measurement">Pattern 6 - Measurement</h2>
                <ul>
                    <li><strong>Purpose</strong>: Represent measured value of some material characteristic.</li>
                    <li><strong>Example Use Case</strong>: This example represents a measurement workflow with an assay,
                        evaluant role, quality, measurement datum, and value specification.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-measurement">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 6 - Measurement</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-measurement">
                            <div class="mermaid-diagram" id="diagram-measurement"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-class"></span>Class (TBox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <pre><code>@prefix : &lt;https://w3id.org/pmd/co/test/shape3/&gt; .
@prefix assay: &lt;http://purl.obolibrary.org/obo/OBI_0000070&gt; .
@prefix realizes: &lt;http://purl.obolibrary.org/obo/BFO_0000055&gt; .
@prefix has_specified_input: &lt;http://purl.obolibrary.org/obo/OBI_0000293&gt; .
@prefix has_specified_output: &lt;http://purl.obolibrary.org/obo/OBI_0000299&gt; .
@prefix evaluant_role: &lt;http://purl.obolibrary.org/obo/OBI_0000067&gt; .
@prefix quality: &lt;http://purl.obolibrary.org/obo/BFO_0000019&gt; . 
@prefix material_entity: &lt;http://purl.obolibrary.org/obo/BFO_0000040&gt; . 
@prefix has_quality: &lt;http://purl.obolibrary.org/obo/RO_0000086&gt; . 
@prefix has_role: &lt;http://purl.obolibrary.org/obo/RO_0000087&gt; . 
@prefix scalar_measurement_datum: &lt;http://purl.obolibrary.org/obo/IAO_0000032&gt; .
@prefix is_quality_measurement_of: &lt;http://purl.obolibrary.org/obo/IAO_0000221&gt; . 
@prefix has_value_specification: &lt;http://purl.obolibrary.org/obo/OBI_0001938&gt; .
@prefix achieves_planned_objective: &lt;http://purl.obolibrary.org/obo/OBI_0000417&gt; .
@prefix is_about: &lt;http://purl.obolibrary.org/obo/IAO_0000136&gt; .
@prefix specifies_value_of: &lt;http://purl.obolibrary.org/obo/OBI_0001927&gt; .

:my_assay a assay: ;
    realizes: :my_entities_evaluant_role ;
    has_specified_input: :my_evaluated_entity ;
    has_specified_output: :my_qualities_measurement_datum ;
    achieves_planned_objective: :my_objective .

:my_objective is_about: :my_evaluated_entity .

:my_entities_quality a quality: .

:my_evaluated_entity a material_entity: ;
    has_quality: :my_entities_quality ;
    has_role: :my_entities_evaluant_role .

:my_entities_evaluant_role a evaluant_role: .

:my_qualities_measurement_datum a scalar_measurement_datum: ;
    is_about: :my_evaluated_entity ;
    is_quality_measurement_of: :my_entities_quality ;
    has_value_specification: :my_value_specification .

:my_value_specification specifies_value_of: :my_entities_quality .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/measurement">patterns/measurement</a>)
                </p>

                <hr />

                <!-- Pattern 7 -->
                <h2 id="pattern-7---scalar-value-specification">Pattern 7 - Scalar Value Specification</h2>
                <ul>
                    <li><strong>Purpose</strong>: Represents scalar physical quantities, combining a numerical value and
                        a unit.</li>
                    <li><strong>Core Properties</strong>: obi:hasSpecifiedNumericValue, iao:hasMeasurementUnitLabel</li>
                    <li><strong>Example Use Case</strong>: A scalar value specification with numeric value 135.0 linked
                        to a measurement unit.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-scalar-value">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 7 - Scalar Value Specification</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-scalar-value">
                            <div class="mermaid-diagram" id="diagram-scalar-value"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-class"></span>Class (TBox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-literal"></span>Literal</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;https://www.example.org/&gt; .
@prefix has_measurement_unit_label: &lt;http://purl.obolibrary.org/obo/IAO_0000039&gt; .
@prefix has_specified_numeric_value: &lt;http://purl.obolibrary.org/obo/OBI_0001937&gt; .
@prefix measurement_unit_label: &lt;http://purl.obolibrary.org/obo/IAO_0000003&gt; .
@prefix scalar_value_specification: &lt;http://purl.obolibrary.org/obo/OBI_0001931&gt; .

ex:scalar_value_specification_X rdf:type scalar_value_specification: ;
    has_measurement_unit_label: ex:unit_X ;
    has_specified_numeric_value: 135.0 .

ex:unit_X rdf:type measurement_unit_label: .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/scalar%20value%20specification">patterns/scalar
                        value specification</a>)</p>

                <hr />

                <!-- Pattern 8 -->
                <h2 id="pattern-8---categorical-value-specification">Pattern 8 - Categorical Value Specification</h2>
                <ul>
                    <li><strong>Purpose</strong>: Represents how categorical values such as ferrite, face-centered
                        cubic, and liquid are used to specify the values of material characteristics.</li>
                    <li><strong>Example Use Case</strong>: A material with crystal structure quality assigned
                        "face-centered cubic" and grain structure quality assigned "ferrite". A melt with aggregate
                        state quality assigned "liquid".</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-categorical-value">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 8 - Categorical Value Specification</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-categorical-value">
                            <div class="mermaid-diagram" id="diagram-categorical-value"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-pmd"></span>PMD Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-categorical"></span>Categorical
                            Value</span>
                    </div>
                </div>

                <pre><code>@prefix ex: &lt;http://www.example.org/#&gt; .
@prefix material: &lt;https://w3id.org/pmd/co/PMD_0000000&gt; .
@prefix melt: &lt;https://w3id.org/pmd/co/PMD_0020139&gt; .
@prefix crystal_structure: &lt;https://w3id.org/pmd/co/PMD_0000591&gt; .
@prefix metallic_grain_structure: &lt;https://w3id.org/pmd/co/PMD_0025003&gt; .
@prefix aggregate_state: &lt;https://w3id.org/pmd/co/PMD_0000512&gt; .
@prefix bravais_lattice_cubic_face_centered: &lt;https://w3id.org/pmd/co/PMD_0020019&gt; .
@prefix ferrite: &lt;https://w3id.org/pmd/co/PMD_0020100&gt; .
@prefix aggregate_state_liquid: &lt;https://w3id.org/pmd/co/PMD_0020118&gt; .
@prefix has_quality: &lt;http://purl.obolibrary.org/obo/RO_0000086&gt; .
@prefix specifies_value_of: &lt;http://purl.obolibrary.org/obo/OBI_0001927&gt; .

ex:fcc_material a material: ;
    has_quality: ex:crystal_structure_quality, ex:grain_structure_quality .

ex:crystal_structure_quality a crystal_structure: .
bravais_lattice_cubic_face_centered: specifies_value_of: ex:crystal_structure_quality .

ex:grain_structure_quality a metallic_grain_structure: .
ferrite: specifies_value_of: ex:grain_structure_quality .

ex:steel_melt a melt: ;
    has_quality: ex:aggregate_state_quality .

ex:aggregate_state_quality a aggregate_state: .
aggregate_state_liquid: specifies_value_of: ex:aggregate_state_quality .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns/categorical%20value%20specification">patterns/categorical
                        value specification</a>)</p>

                <hr />

                <!-- Pattern 9 -->
                <h2 id="pattern-9---simulation-input-output">Pattern 9 - Simulation Input/Output</h2>
                <ul>
                    <li><strong>Purpose</strong>: Information content entities as input and output of simulation
                        processes.</li>
                    <li><strong>Example Use Case</strong>: A division calculation process where two numbers (ICEs) serve
                        as inputs through input assignments (numerator and denominator), with the quotient participating
                        in an output assignment.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-simulation-io">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 9 - Simulation Input/Output</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-simulation-io">
                            <div class="mermaid-diagram" id="diagram-simulation-io"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-class"></span>Class (TBox)</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <pre><code>@prefix : &lt;http://example.org/division#&gt; .
@prefix hasParticipant: &lt;http://purl.obolibrary.org/obo/RO_0000057&gt; .
@prefix partOf: &lt;http://purl.obolibrary.org/obo/BFO_0000050&gt; .
@prefix InformationContentEntity: &lt;http://purl.obolibrary.org/obo/IAO_0000030&gt; .
@prefix SimulationProcess: &lt;https://w3id.org/pmd/co/PMD_0000933&gt; .
@prefix InputAssignment: &lt;https://w3id.org/pmd/co/PMD_0000066&gt; .
@prefix OutputAssignment: &lt;https://w3id.org/pmd/co/PMD_0000067&gt; .
@prefix hasSpecifiedValue: &lt;http://purl.obolibrary.org/obo/OBI_0001937&gt; .
@prefix isSpecifiedInputOf: &lt;http://purl.obolibrary.org/obo/OBI_0000295&gt; .
@prefix isSpecifiedOutputOf: &lt;http://purl.obolibrary.org/obo/OBI_0000312&gt; .

:Number rdfs:subClassOf InformationContentEntity: .
:DivisionProcess rdfs:subClassOf SimulationProcess: .
:NumeratorAssignment rdfs:subClassOf InputAssignment: .
:DenominatorAssignment rdfs:subClassOf InputAssignment: .
:QuotientAssignment rdfs:subClassOf OutputAssignment: .

:num1 a :Number ; hasSpecifiedValue: "10"^^xsd:integer ; isSpecifiedInputOf: :div1 .
:num2 a :Number ; hasSpecifiedValue: "2"^^xsd:integer ; isSpecifiedInputOf: :div1 .
:quotient1 a :Number ; hasSpecifiedValue: "5"^^xsd:integer ; isSpecifiedOutputOf: :div1 .

:div1 a :DivisionProcess .
:numerator_assign a :NumeratorAssignment ; hasParticipant: :num1 ; partOf: :div1 .
:denominator_assign a :DenominatorAssignment ; hasParticipant: :num2 ; partOf: :div1 .
:quotient_assign a :QuotientAssignment ; hasParticipant: :quotient1 ; partOf: :div1 .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns">patterns</a>)</p>

                <hr />

                <!-- Pattern 10 -->
                <h2 id="pattern-10---bronze-alloy-formation">Pattern 10 - Bronze Alloy Formation (Process Sequence with
                    TQC)</h2>
                <ul>
                    <li><strong>Purpose</strong>: Detailed example of process sequence with temporally qualified
                        continuants as well as changing qualities over time.</li>
                    <li><strong>Example Use Case</strong>: Creation of a bronze alloy through a sequence of melting
                        copper and tin, mixing the molten metals, and solidification to produce the final bronze alloy.
                    </li>
                </ul>

                <p>The scenario describes a sequence of processes involved in the formation of a bronze alloy. The
                    process begins with two pieces of raw materials: copper and tin. At first, each material exists in
                    its solid state, represented by different amounts of copper and tin at various points in time. These
                    materials change their properties as they move through the different stages of the process.</p>

                <p>The first stage is <strong>melting</strong>, which takes place separately for copper and tin. Copper
                    is melted in one furnace, and tin in another. Each furnace performs its specific melting function,
                    heating the metals until they become liquid. Once the tin and copper have been molten, they are
                    ready to be combined.</p>

                <p>The next stage is <strong>mixing</strong> the molten metals. The molten copper and tin are poured
                    together into a mold, where they mix thoroughly to form liquid bronze. This mixing process serves as
                    a bridge between melting and the next phase of production.</p>

                <p>After the metals have been mixed, <strong>solidification</strong> occurs. The molten bronze cools and
                    hardens inside the mold, producing the final solid bronze alloy. The mold itself plays a key role in
                    this step, enabling the cooling and shaping of the metal as it transitions from liquid to solid
                    form.</p>

                <div class="mermaid-graph-container" id="graph-bronze-alloy">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 10 - Bronze Alloy Formation</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-bronze-alloy">
                            <div class="mermaid-diagram" id="diagram-bronze-alloy"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-bfo"></span>BFO Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-obi"></span>OBI Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-pmd"></span>PMD Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-individual"></span>Individual
                            (ABox)</span>
                    </div>
                </div>

                <h3>Description</h3>
                <p>The pattern models a coherent sequence of metallurgical activities: Melting copper and tin
                    separately, Mixing the molten metals to form a bronze melt, and Solidifying the mixture to produce
                    the final bronze alloy.</p>

                <p>The pattern describes a sequence of processes involved in the formation of a bronze alloy. The
                    process begins with two materials: copper and tin. Initially, certain amounts of tin (some_tin) and
                    copper (some_cu) exist before the melting process starts. These materials are associated with their
                    respective temporal states (e.g., :some_cu_at_t1, :some_tin_at_t1), which are modeled as instances
                    of temporally qualified continuant and as bearers of particular qualities (such as aggregate state),
                    reflecting how the materials change over time.</p>

                <p>The melting phase involves separate activities for copper and tin. The melting_copper process,
                    classified as an instance of melting process and has furnace_1 as participant. Similarly,
                    melting_tin is another instance of the same process type; it operates with furnace_2 on
                    some_tin_at_t1 and subsequently produces some_tin_at_t3. Both furnace_1 and furnace_2 are
                    represented as instances of furnace, and both melting processes realize the furnaces' melting
                    functions.</p>

                <p>After both metals have been melted, the next stage is the mixing of the molten metals. This is
                    represented by the mixing_melts process, an instance of material combination. During this phase,
                    some_cu_at_t2 and some_tin_at_t3 are combined to form bronze_at_t4. The mixing occurs within a mold
                    device, and the mixing_melts process directly contributes to the larger bronze_alloy_formation
                    process.</p>

                <p>Once the molten bronze has been formed, solidification takes place. This process acts on
                    bronze_at_t4, producing bronze_at_t5 as the solidified output. The solidification step is part of
                    the same overall alloy formation sequence and follows the mixing phase in temporal order. This
                    process also realizes the mold's cooling function.</p>

                <pre><code>@prefix : &lt;https://w3id.org/pmd/co/test/&gt; .
@prefix portion_of_copper: &lt;https://w3id.org/pmd/co/PMD_0020054&gt; .
@prefix portion_of_tin: &lt;https://w3id.org/pmd/co/PMD_0020088&gt; .
@prefix bronze_alloy: &lt;http://example.org/bronze&gt; .
@prefix metal: &lt;https://w3id.org/pmd/co/PMD_0000852&gt; .
@prefix furnace: &lt;https://w3id.org/pmd/co/PMD_0000655&gt; .
@prefix manufacturing_process: &lt;https://w3id.org/pmd/co/PMD_0000833&gt; .
@prefix melting_process: &lt;https://w3id.org/pmd/co/PMD_0000053&gt; .
@prefix mixing_process: &lt;https://w3id.org/pmd/co/PMD_0000778&gt; . 
@prefix solidification_process: &lt;https://w3id.org/pmd/co/PMD_0000906&gt; . 
@prefix mold_device: &lt;https://w3id.org/pmd/co/PMD_0000075&gt; .
@prefix aggregate_state: &lt;https://w3id.org/pmd/co/PMD_0000512&gt; .
@prefix solid: &lt;https://w3id.org/pmd/co/PMD_0020117&gt; .
@prefix liquid: &lt;https://w3id.org/pmd/co/PMD_0020118&gt; .

@prefix has_specified_input: &lt;http://purl.obolibrary.org/obo/OBI_0000293&gt; .
@prefix has_part: &lt;http://purl.obolibrary.org/obo/BFO_0000051&gt; . 
@prefix has_participant: &lt;http://purl.obolibrary.org/obo/RO_0000057&gt; . 
@prefix has_specified_output: &lt;http://purl.obolibrary.org/obo/OBI_0000299&gt; .
@prefix precedes: &lt;http://purl.obolibrary.org/obo/BFO_0000063&gt; .
@prefix realizes: &lt;http://purl.obolibrary.org/obo/BFO_0000055&gt; .
@prefix starts_with: &lt;http://purl.obolibrary.org/obo/RO_0002224&gt; .
@prefix ends_with: &lt;http://purl.obolibrary.org/obo/RO_0002230&gt; .
@prefix has_quality: &lt;http://purl.obolibrary.org/obo/RO_0000086&gt; .
@prefix concretizes: &lt;http://purl.obolibrary.org/obo/RO_0000059&gt; .

:some_cu a portion_of_copper: .
:some_tin a portion_of_tin: .

:some_cu_at_t1 a portion_of_copper: ;
               has_quality: :q1 .
:q1 a aggregate_state:; concretizes: solid: .

:some_cu_at_t2 a portion_of_copper: ;
               has_quality: :q2 .
:q2 a aggregate_state:; concretizes: liquid: .

:some_tin_at_t1 a portion_of_tin: ;
                has_quality: :q3 .
:q3 a aggregate_state:; concretizes: solid: .

:some_tin_at_t3 a portion_of_tin: ;
                has_quality: :q4 .
:q4 a aggregate_state:; concretizes: liquid: .

:furnace_1 a furnace: .
:furnace_2 a furnace: .
:mold a mold_device: .

:bronze_alloy_formation a manufacturing_process: ;
    has_specified_input: :some_cu, :some_tin ;
    has_part: :melting_copper, :melting_tin, :mixing_melts, :solidification ;
    has_specified_output: :some_bronze ;
    starts_with: :melting_copper ;
    ends_with: :solidification .

:melting_copper a melting_process: ;
    has_specified_input: :some_cu_at_t1 ;
    has_participant: :furnace_1 ;
    has_specified_output: :some_cu_at_t2 ;
    precedes: :mixing_melts .

:melting_tin a melting_process: ;
    has_specified_input: :some_tin_at_t1 ;
    has_participant: :furnace_2 ;
    has_specified_output: :some_tin_at_t3 ;
    precedes: :mixing_melts .

:mixing_melts a mixing_process: ;
    has_participant: :mold ;
    has_specified_input: :some_cu_at_t2, :some_tin_at_t3 ;
    has_specified_output: :bronze_at_t4 ;
    precedes: :solidification .

:solidification a solidification_process: ;
    has_participant: :mold ;
    has_specified_input: :bronze_at_t4 ;
    has_specified_output: :bronze_at_t5 .

:some_bronze a bronze_alloy: .
:bronze_at_t4 has_quality: :q5 .
:bronze_at_t5 has_quality: :q6 .
:q5 a aggregate_state:; concretizes: liquid: .
:q6 a aggregate_state:; concretizes: solid: .</code></pre>

                <p>(see folder: <a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns">patterns</a>)</p>

                <hr />

                <!-- Pattern 11 - Fraction Value Specification (SHACL) -->
                <h2 id="pattern-11---fraction-value-specification">Pattern 11 - Fraction Value Specification (SHACL
                    Shape)</h2>
                <ul>
                    <li><strong>Purpose</strong>: Define constraints for fraction value specifications using SHACL
                        shapes.</li>
                    <li><strong>Example Use Case</strong>: Validating that fraction specifications have exactly one
                        numeric value (max 100) and exactly one measurement unit from allowed UO individuals.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-fraction-shacl">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 11 - Fraction Value Specification (SHACL)</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-fraction-shacl">
                            <div class="mermaid-diagram" id="diagram-fraction-shacl"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-shacl"></span>SHACL Shape</span>
                        <span class="legend-item"><span class="legend-swatch swatch-constraint"></span>Constraint</span>
                        <span class="legend-item"><span class="legend-swatch swatch-obi"></span>OBI/IAO Class</span>
                        <span class="legend-item"><span class="legend-swatch swatch-pmd"></span>PMD Class</span>
                    </div>
                </div>

                <pre><code>@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt; .
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt; .
@prefix obo: &lt;http://purl.obolibrary.org/obo/&gt; .
@prefix shape: &lt;https://w3id.org/pmd/co/shapes&gt; .

shape:fraction_value_specification
    rdf:type sh:NodeShape ;
    sh:targetClass &lt;https://w3id.org/pmd/co/PMD_0025997&gt; ; # fraction value specification
    
    # Exactly one property pointing to the scalar value
    sh:property [
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:maxInclusive 100 ;
        sh:datatype xsd:float ;
        sh:message "The numerical value must be present, unique, and not exceed 100." ;
        sh:path obo:OBI_0001937  # has specified numeric value
    ] ;

    # Exactly one property pointing to the physical unit from UO
    sh:property [           
        sh:path obo:IAO_0000039 ; # has measurement unit label
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:in (
            obo:UO_0000163  # mass percentage
            obo:UO_0000165  # volume percentage
            obo:UO_0000076  # mole fraction
        ) ; 
        sh:message "Unit must be mass percentage, volume percentage, or mole fraction." ;
    ] ;
    
    sh:property [
        sh:path obo:OBI_0001927 ; # specifies value of 
        sh:class obo:BFO_0000001 ; # entity
    ] ;
   
    sh:closed false .</code></pre>

                <hr />

                <!-- Pattern 12 - Device Identification (SHACL) -->
                <h2 id="pattern-12---device-identification">Pattern 12 - Device Identification (SHACL Shape)</h2>
                <ul>
                    <li><strong>Purpose</strong>: Define constraints for device identification using either IAO
                        identifiers or symbols.</li>
                    <li><strong>Example Use Case</strong>: Validating that devices are denoted by either an IAO
                        identifier or an IAO symbol with proper value specifications.</li>
                </ul>

                <div class="mermaid-graph-container" id="graph-device-shacl">
                    <div class="graph-header">
                        <div class="graph-title">Pattern 12 - Device Identification (SHACL)</div>
                        <div class="graph-controls">
                            <button class="graph-btn" data-action="fit"> Fit</button>
                            <button class="graph-btn" data-action="reset"> Reset</button>
                            <button class="graph-btn" data-action="fullscreen"> Fullscreen</button>
                            <button class="graph-btn" data-action="svg"> SVG</button>
                        </div>
                    </div>
                    <div class="graph-viewport">
                        <div class="graph-wrapper" id="wrapper-device-shacl">
                            <div class="mermaid-diagram" id="diagram-device-shacl"></div>
                        </div>
                        <div class="zoom-controls">
                            <button class="zoom-btn" data-action="zoom-in">+</button>
                            <div class="zoom-level">100%</div>
                            <button class="zoom-btn" data-action="zoom-out"></button>
                        </div>
                    </div>
                    <div class="graph-legend">
                        <span class="legend-item"><span class="legend-swatch swatch-shacl"></span>SHACL Shape</span>
                        <span class="legend-item"><span class="legend-swatch swatch-constraint"></span>Constraint</span>
                        <span class="legend-item"><span class="legend-swatch swatch-obi"></span>OBI/IAO Class</span>
                    </div>
                </div>

                <pre><code>@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt; .
@prefix obi: &lt;http://purl.obolibrary.org/obo/&gt; .
@prefix ex: &lt;http://www.example.org/#&gt; .

ex:Shape6 a sh:NodeShape ;
    sh:targetClass obi:OBI_0000968 ; # device	
    sh:or (
        ex:Shape6_identifier
        ex:Shape6_symbol
    ) .

ex:Shape6_identifier a sh:NodeShape ;
    sh:property [
        sh:path obi:IAO_0000235 ; # denoted by
        sh:qualifiedValueShape [
            sh:class obi:IAO_0020000 ; # iao identifier
        ];
        sh:qualifiedMinCount 1 ; 
    ];
    sh:property [
        sh:path (
            obi:IAO_0000235 # denoted by
            obi:OBI_0001938 # has value specification
            obi:OBI_0002135 # has specified value
        ) ;
        sh:nodeKind sh:IRIOrLiteral;
        sh:minCount 1 ;
    ] .

ex:Shape6_symbol a sh:NodeShape ;
    sh:property [
        sh:path obi:IAO_0000235 ; # denoted by
        sh:qualifiedValueShape [
            sh:class obi:IAO_0000028 ; # iao symbol
        ];
        sh:qualifiedMinCount 1 ; 
    ];
    sh:property [
        sh:path (
            obi:IAO_0000235 # denoted by
            obi:OBI_0001938 # has value specification
            obi:OBI_0002135 # has specified value
        ) ;
        sh:nodeKind sh:IRIOrLiteral;
        sh:minCount 1 ;
    ] .</code></pre>

                <hr />

                <h2 id="more-patterns-at-github">More patterns at GitHub</h2>
                <p>More patterns can be found in the patterns folder:</p>
                <p><a
                        href="https://github.com/materialdigital/core-ontology/tree/main/patterns">https://github.com/materialdigital/core-ontology/tree/main/patterns</a>
                </p>

            </article>

            <nav class="page-nav">
                <a class="page-nav-link prev" href="./ontology-structure.html"><span class="page-nav-label">&larr;
                        Previous</span><span class="page-nav-title">Ontology Structure</span></a>
                <a class="page-nav-link next" href="./user-guide.html">
                    <span class="page-nav-label">Next </span>
                    <span class="page-nav-title">User Guide</span>
                </a>
            </nav>

            <footer class="footer">
                <div class="footer-links">
                    <a href="https://github.com/materialdigital/core-ontology" target="_blank">GitHub</a>
                    <a href="https://materialdigital.de/" target="_blank">MaterialDigital</a>
                    <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>
                </div>
                <p class="footer-copyright"> 2024 Platform MaterialDigital. All rights reserved.</p>
            </footer>
        </div>
    </main>

    <aside class="toc">
        <h4 class="toc-title">On this page</h4>
        <ul class="toc-list">
            <li><a href="#usage-patterns">Usage Patterns</a></li>
            <li><a href="#pattern-1---temporal-region">Pattern 1 - Temporal Region</a></li>
            <li><a href="#pattern-2---process-chain">Pattern 2 - Process Chain</a></li>
            <li><a href="#pattern-3---process-inputs-and-outputs">Pattern 3 - Process I/O</a></li>
            <li><a href="#pattern-4---realizable-entities-role">Pattern 4 - Role</a></li>
            <li><a href="#pattern-5---material-properties-qualities">Pattern 5 - Qualities</a></li>
            <li><a href="#pattern-6---measurement">Pattern 6 - Measurement</a></li>
            <li><a href="#pattern-7---scalar-value-specification">Pattern 7 - Scalar Value</a></li>
            <li><a href="#pattern-8---categorical-value-specification">Pattern 8 - Categorical Value</a></li>
            <li><a href="#pattern-9---simulation-input-output">Pattern 9 - Simulation I/O</a></li>
            <li><a href="#pattern-10---bronze-alloy-formation">Pattern 10 - Bronze Alloy</a></li>
            <li><a href="#pattern-11---fraction-value-specification">Pattern 11 - Fraction (SHACL)</a></li>
            <li><a href="#pattern-12---device-identification">Pattern 12 - Device (SHACL)</a></li>
            <li><a href="#more-patterns-at-github">More patterns</a></li>
        </ul>
    </aside>

    <!-- Global popover and toast elements -->
    <div class="graph-popover" id="global-popover"></div>
    <div class="graph-toast" id="global-toast"></div>

    <!-- Fullscreen overlay -->
    <div class="fullscreen-overlay" id="fullscreen-overlay">
        <div class="fullscreen-header">
            <div class="fullscreen-title" id="fullscreen-title">Graph</div>
            <button class="fullscreen-close" id="fullscreen-close">
                <span></span> Close
            </button>
        </div>
        <div class="fullscreen-viewport" id="fullscreen-viewport">
            <div class="fullscreen-wrapper" id="fullscreen-wrapper"></div>
            <div class="fullscreen-zoom-controls">
                <button class="fullscreen-zoom-btn" id="fs-zoom-in">+</button>
                <div class="fullscreen-zoom-level" id="fs-zoom-level">100%</div>
                <button class="fullscreen-zoom-btn" id="fs-zoom-out"></button>
            </div>
        </div>
    </div>

    <script type="module">
        import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

        // ========== MERMAID DIAGRAMS ==========
        const diagrams = {
            "temporal-region": `flowchart BT
subgraph TBOX[" "]
direction BT
  bfo_occurrent["bfo:occurrent"]
  bfo_process["bfo:process"]
  bfo_continuant["bfo:continuant"]
  bfo_temporal_region["bfo:temporal_region"]
  bfo_1dtr["bfo:1D_temporal_region"]
  bfo_0dtr["bfo:0D_temporal_region"]
end
bfo_process -->|rdfs:subClassOf| bfo_occurrent
bfo_temporal_region -->|rdfs:subClassOf| bfo_occurrent
bfo_1dtr -->|rdfs:subClassOf| bfo_temporal_region
bfo_0dtr -->|rdfs:subClassOf| bfo_temporal_region
subgraph ABOX[" "]
direction BT
  ex_process_1["ex:process_1"]
  ex_process_2["ex:process_2"]
  ex_period_1["ex:period_1"]
  ex_period_2["ex:period_2"]
  ex_some_time["ex:some_time"]
  ex_object_1["ex:object_1"]
  ex_start["ex:start"]
  ex_end["ex:end"]
end
ex_process_1 -.->|rdf:type| bfo_process
ex_process_2 -.->|rdf:type| bfo_process
ex_period_1 -.->|rdf:type| bfo_1dtr
ex_period_2 -.->|rdf:type| bfo_1dtr
ex_some_time -.->|rdf:type| bfo_temporal_region
ex_object_1 -.->|rdf:type| bfo_continuant
ex_start -.->|rdf:type| bfo_0dtr
ex_end -.->|rdf:type| bfo_0dtr
ex_process_1 -->|occupies_temporal_region| ex_period_1
ex_process_2 -->|occupies_temporal_region| ex_period_2
ex_period_1 -->|proper_temporal_part_of| ex_period_2
ex_period_2 -->|has_first_instant| ex_start
ex_period_2 -->|has_last_instant| ex_end
ex_object_1 -->|exists_at| ex_some_time
classDef cls fill:#b34dff,stroke:#4a148c,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class bfo_occurrent,bfo_process,bfo_continuant,bfo_temporal_region,bfo_1dtr,bfo_0dtr cls;
class ex_process_1,ex_process_2,ex_period_1,ex_period_2,ex_some_time,ex_object_1,ex_start,ex_end ind;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "process-chain": `flowchart BT
subgraph TBOX[" "]
  bfo_process["bfo:process"]
end
subgraph ABOX[" "]
direction BT
  ex_process_parent["ex:process_parent"]
  ex_process_step1["ex:process_step1"]
  ex_process_step2a["ex:process_step2a"]
  ex_process_step2b["ex:process_step2b"]
  ex_process_step3["ex:process_step3"]
end
ex_process_parent -.->|rdf:type| bfo_process
ex_process_step1 -.->|rdf:type| bfo_process
ex_process_step2a -.->|rdf:type| bfo_process
ex_process_step2b -.->|rdf:type| bfo_process
ex_process_step3 -.->|rdf:type| bfo_process
ex_process_parent -->|starts_with| ex_process_step1
ex_process_parent -->|ends_with| ex_process_step3
ex_process_parent -->|has_part| ex_process_step1
ex_process_parent -->|has_part| ex_process_step2a
ex_process_parent -->|has_part| ex_process_step2b
ex_process_parent -->|has_part| ex_process_step3
ex_process_step1 -->|precedes| ex_process_step2a
ex_process_step1 -->|precedes| ex_process_step2b
ex_process_step2a -->|precedes| ex_process_step3
ex_process_step2b -->|precedes| ex_process_step3
ex_process_step2a ---|simultaneous_with| ex_process_step2b
classDef cls fill:#b34dff,stroke:#4a148c,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class bfo_process cls;
class ex_process_parent,ex_process_step1,ex_process_step2a,ex_process_step2b,ex_process_step3 ind;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "process-io": `flowchart BT
  ex_process1["ex:process 1"]
  ex_process2["ex:process 2"]
  ex_object1["ex:object1"]
  ex_object2["ex:object2"]
  ex_object3["ex:object3"]
  
  pmd_coating["pmd:coating_process"]
  pmd_manufacturing["pmd:manufacturing_process"]
  obi_planned_process["obi:planned_process"]
  bfo_process["bfo:process"]
  bfo_object["bfo:object"]
  
  pmd_coating -->|owl:subClassOf| pmd_manufacturing
  pmd_manufacturing -->|owl:subClassOf| obi_planned_process
  obi_planned_process -->|owl:subClassOf| bfo_process
  
  ex_process1 -.->|rdf:type| pmd_coating
  ex_process2 -.->|rdf:type| pmd_coating
  ex_object1 -.->|rdf:type| bfo_object
  ex_object2 -.->|rdf:type| bfo_object
  ex_object3 -.->|rdf:type| bfo_object
  
  ex_object1 -->|obi:has_specified_input| ex_process1
  ex_process1 -->|obi:has_specified_output| ex_object2
  ex_object2 -->|obi:has_specified_input| ex_process2
  ex_process2 -->|obi:has_specified_output| ex_object3

classDef bfo fill:#b34dff,stroke:#7c3aed,stroke-width:2px,color:#fff;
classDef obi fill:#a78bbc,stroke:#7c5c8f,stroke-width:2px,color:#fff;
classDef pmd fill:#6b7fa3,stroke:#4a5568,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class bfo_process,bfo_object bfo;
class obi_planned_process obi;
class pmd_manufacturing,pmd_coating pmd;
class ex_process1,ex_process2,ex_object1,ex_object2,ex_object3 ind;`,

            "role-pattern": `flowchart BT
subgraph TBOX[" "]
direction BT
  bfo_object["bfo:object"]
  obi_evaluant_role["obi:evaluant_role"]
  pmd_fatigue_testing["pmd:fatigue_testing_process"]
end
subgraph ABOX[" "]
direction BT
  ex_process_1["ex:process_1"]
  ex_object_1["ex:object_1"]
  ex_role_1["ex:role_1"]
  ex_objective_1["ex:objective_1"]
  ex_result_1["ex:result_1"]
end
ex_process_1 -.->|rdf:type| pmd_fatigue_testing
ex_object_1 -.->|rdf:type| bfo_object
ex_role_1 -.->|rdf:type| obi_evaluant_role
ex_process_1 -->|has_specified_input| ex_object_1
ex_process_1 -->|achieves_planned_objective| ex_objective_1
ex_process_1 -->|has_specified_output| ex_result_1
ex_objective_1 -->|is_about| ex_object_1
ex_result_1 -->|is_about| ex_object_1
ex_object_1 -->|has_role| ex_role_1
ex_role_1 -->|has_realization| ex_process_1
classDef cls fill:#b34dff,stroke:#4a148c,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class bfo_object,obi_evaluant_role,pmd_fatigue_testing cls;
class ex_process_1,ex_object_1,ex_role_1,ex_objective_1,ex_result_1 ind;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "measurement": `flowchart BT
subgraph TBOX[" "]
direction BT
  obi_assay["obi:assay"]
  obi_evaluant_role["obi:evaluant_role"]
  bfo_quality["bfo:quality"]
  bfo_material_entity["bfo:material_entity"]
  iao_scalar_datum["iao:scalar_measurement_datum"]
end
subgraph ABOX[" "]
direction BT
  my_assay["my_assay"]
  my_evaluant_role["my_evaluant_role"]
  my_quality["my_quality"]
  my_entity["my_evaluated_entity"]
  my_datum["my_measurement_datum"]
  my_value_spec["my_value_specification"]
  my_objective["my_objective"]
end
my_assay -.->|rdf:type| obi_assay
my_evaluant_role -.->|rdf:type| obi_evaluant_role
my_quality -.->|rdf:type| bfo_quality
my_entity -.->|rdf:type| bfo_material_entity
my_datum -.->|rdf:type| iao_scalar_datum
my_assay -->|realizes| my_evaluant_role
my_assay -->|has_specified_input| my_entity
my_assay -->|has_specified_output| my_datum
my_assay -->|achieves_planned_objective| my_objective
my_objective -->|is_about| my_entity
my_entity -->|has_quality| my_quality
my_entity -->|has_role| my_evaluant_role
my_datum -->|is_about| my_entity
my_datum -->|is_quality_measurement_of| my_quality
my_datum -->|has_value_specification| my_value_spec
my_value_spec -->|specifies_value_of| my_quality
classDef cls fill:#b34dff,stroke:#4a148c,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class obi_assay,obi_evaluant_role,bfo_quality,bfo_material_entity,iao_scalar_datum cls;
class my_assay,my_evaluant_role,my_quality,my_entity,my_datum,my_value_spec,my_objective ind;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "material-properties": `flowchart BT
  ex_metal_sheet["ex:metal_sheet"]
  ex_mass_metal_sheet["ex:mass_metal_sheet"]
  ex_svs_3_3_g["ex:svs_3.3g"]
  ex_steel_material["ex:steel_material"]
  ex_density_steel["ex:density_steel"]
  ex_melting_temp["ex:melting_temperature"]
  ex_melting_process["ex:melting_process"]

  bfo_object["bfo:object"]
  pmd_material["pmd:material"]
  bfo_quality["bfo:quality"]
  pmd_mass["pmd:mass"]
  pmd_density["pmd:density"]
  pmd_melting_point["pmd:melting_point"]
  pmd_melting_process["pmd:melting_process"]
  obi_svs["obi:scalar_value_specification"]

  pmd_mass -->|rdfs:subClassOf| bfo_quality
  pmd_density -->|rdfs:subClassOf| bfo_quality
  pmd_melting_point -->|rdfs:subClassOf| bfo_quality

  ex_metal_sheet -.->|rdf:type| bfo_object
  ex_mass_metal_sheet -.->|rdf:type| pmd_mass
  ex_svs_3_3_g -.->|rdf:type| obi_svs
  ex_steel_material -.->|rdf:type| pmd_material
  ex_density_steel -.->|rdf:type| pmd_density
  ex_melting_temp -.->|rdf:type| pmd_melting_point
  ex_melting_process -.->|rdf:type| pmd_melting_process
  ex_mass_metal_sheet -->|quality_of| ex_metal_sheet
  ex_svs_3_3_g -->|specifies_value_of| ex_mass_metal_sheet
  ex_density_steel -->|quality_of| ex_steel_material
  ex_melting_temp -->|characteristic_of| ex_steel_material
  ex_melting_temp -->|has_realization| ex_melting_process

classDef bfo fill:#b34dff,stroke:#7c3aed,stroke-width:2px,color:#fff;
classDef obi fill:#a78bbc,stroke:#7c5c8f,stroke-width:2px,color:#fff;
classDef pmd fill:#6b7fa3,stroke:#4a5568,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class bfo_object,bfo_quality bfo;
class obi_svs obi;
class pmd_material,pmd_mass,pmd_density,pmd_melting_point,pmd_melting_process pmd;
class ex_metal_sheet,ex_mass_metal_sheet,ex_svs_3_3_g,ex_steel_material,ex_density_steel,ex_melting_temp,ex_melting_process ind;`,

            "scalar-value": `flowchart BT
subgraph TBOX[" "]
direction BT
  obi_svs["obi:scalar_value_specification"]
  iao_unit["iao:measurement_unit_label"]
end
subgraph ABOX[" "]
direction BT
  ex_svs_x["ex:scalar_value_specification_X"]
  ex_unit_x["ex:unit_X"]
end
ex_svs_x -.->|rdf:type| obi_svs
ex_unit_x -.->|rdf:type| iao_unit
ex_svs_x -->|has_measurement_unit_label| ex_unit_x
ex_svs_x -->|has_specified_numeric_value| val_135["135.0"]
classDef cls fill:#b34dff,stroke:#4a148c,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
classDef lit fill:#fef3c7,stroke:#d97706,stroke-width:2px,color:#78350f;
class obi_svs,iao_unit cls;
class ex_svs_x,ex_unit_x ind;
class val_135 lit;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "categorical-value": `flowchart BT
  ex_fcc_material["ex:fcc_material"]
  ex_crystal_qual["ex:crystal_structure_quality"]
  ex_grain_qual["ex:grain_structure_quality"]
  ex_steel_melt["ex:steel_melt"]
  ex_agg_state_qual["ex:aggregate_state_quality"]
  cat_fcc["fcc (cubic face centered)"]
  cat_ferrite["ferrite"]
  cat_liquid["liquid"]

  pmd_material["pmd:material"]
  pmd_melt["pmd:melt"]
  pmd_crystal_struct["pmd:crystal_structure"]
  pmd_grain_struct["pmd:grain_structure"]
  pmd_aggregate_state["pmd:aggregate_state"]

  ex_fcc_material -.->|rdf:type| pmd_material
  ex_steel_melt -.->|rdf:type| pmd_melt
  ex_crystal_qual -.->|rdf:type| pmd_crystal_struct
  ex_grain_qual -.->|rdf:type| pmd_grain_struct
  ex_agg_state_qual -.->|rdf:type| pmd_aggregate_state
  ex_fcc_material -->|has_quality| ex_crystal_qual
  ex_fcc_material -->|has_quality| ex_grain_qual
  cat_fcc -->|specifies_value_of| ex_crystal_qual
  cat_ferrite -->|specifies_value_of| ex_grain_qual
  ex_steel_melt -->|has_quality| ex_agg_state_qual
  cat_liquid -->|specifies_value_of| ex_agg_state_qual

classDef pmd fill:#6b7fa3,stroke:#4a5568,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
classDef cat fill:#d1fae5,stroke:#059669,stroke-width:2px,color:#064e3b;
class pmd_material,pmd_melt,pmd_crystal_struct,pmd_grain_struct,pmd_aggregate_state pmd;
class ex_fcc_material,ex_crystal_qual,ex_grain_qual,ex_steel_melt,ex_agg_state_qual ind;
class cat_fcc,cat_ferrite,cat_liquid cat;`,

            "simulation-io": `flowchart BT
subgraph TBOX[" "]
direction BT
  iao_ice["iao:InformationContentEntity"]
  num_class[":Number"]
  pmd_sim_process["pmd:SimulationProcess"]
  div_process[":DivisionProcess"]
  input_assign["pmd:InputAssignment"]
  output_assign["pmd:OutputAssignment"]
  num_assign[":NumeratorAssignment"]
  denom_assign[":DenominatorAssignment"]
  quot_assign[":QuotientAssignment"]
end
num_class -->|rdfs:subClassOf| iao_ice
div_process -->|rdfs:subClassOf| pmd_sim_process
num_assign -->|rdfs:subClassOf| input_assign
denom_assign -->|rdfs:subClassOf| input_assign
quot_assign -->|rdfs:subClassOf| output_assign
subgraph ABOX[" "]
direction BT
  num1[":num1 = 10"]
  num2[":num2 = 2"]
  quotient1[":quotient1 = 5"]
  div1[":div1"]
  numerator_assign[":numerator_assign"]
  denominator_assign[":denominator_assign"]
  quotient_assign_i[":quotient_assign"]
end
num1 -.->|rdf:type| num_class
num2 -.->|rdf:type| num_class
quotient1 -.->|rdf:type| num_class
div1 -.->|rdf:type| div_process
numerator_assign -.->|rdf:type| num_assign
denominator_assign -.->|rdf:type| denom_assign
quotient_assign_i -.->|rdf:type| quot_assign
num1 -->|isSpecifiedInputOf| div1
num2 -->|isSpecifiedInputOf| div1
quotient1 -->|isSpecifiedOutputOf| div1
numerator_assign -->|hasParticipant| num1
numerator_assign -->|partOf| div1
denominator_assign -->|hasParticipant| num2
denominator_assign -->|partOf| div1
quotient_assign_i -->|hasParticipant| quotient1
quotient_assign_i -->|partOf| div1
classDef cls fill:#b34dff,stroke:#4a148c,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class iao_ice,num_class,pmd_sim_process,div_process,input_assign,output_assign,num_assign,denom_assign,quot_assign cls;
class num1,num2,quotient1,div1,numerator_assign,denominator_assign,quotient_assign_i ind;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "bronze-alloy": `flowchart TB
subgraph TBOX[" "]
direction LR
  bfo_process["bfo:process"]
  obi_planned["obi:planned_process"]
  pmd_manufacturing["pmd:manufacturing_process"]
  pmd_melting["pmd:melting_process"]
  pmd_mixing["pmd:mixing_process"]
  pmd_solidification["pmd:solidification_process"]
  pmd_copper["pmd:portion_of_copper"]
  pmd_tin["pmd:portion_of_tin"]
  pmd_bronze["bronze_alloy"]
  pmd_furnace["pmd:furnace"]
  pmd_mold["pmd:mold_device"]
  pmd_agg_state["pmd:aggregate_state"]
end
subgraph ABOX[" "]
direction LR
  bronze_formation[":bronze_alloy_formation"]
  melting_cu[":melting_copper"]
  melting_tin[":melting_tin"]
  mixing[":mixing_melts"]
  solid[":solidification"]
  some_cu[":some_cu"]
  some_tin[":some_tin"]
  cu_t1[":some_cu_at_t1"]
  cu_t2[":some_cu_at_t2"]
  tin_t1[":some_tin_at_t1"]
  tin_t3[":some_tin_at_t3"]
  bronze_t4[":bronze_at_t4"]
  bronze_t5[":bronze_at_t5"]
  some_bronze[":some_bronze"]
  furnace1[":furnace_1"]
  furnace2[":furnace_2"]
  mold[":mold"]
end
TBOX ~~~ ABOX
bfo_process -->|rdfs:subClassOf| obi_planned
obi_planned -->|rdfs:subClassOf| pmd_manufacturing
pmd_manufacturing -->|rdfs:subClassOf| pmd_melting
pmd_manufacturing -->|rdfs:subClassOf| pmd_mixing
pmd_manufacturing -->|rdfs:subClassOf| pmd_solidification
bronze_formation -.->|rdf:type| pmd_manufacturing
melting_cu -.->|rdf:type| pmd_melting
melting_tin -.->|rdf:type| pmd_melting
mixing -.->|rdf:type| pmd_mixing
solid -.->|rdf:type| pmd_solidification
some_cu -.->|rdf:type| pmd_copper
some_tin -.->|rdf:type| pmd_tin
some_bronze -.->|rdf:type| pmd_bronze
furnace1 -.->|rdf:type| pmd_furnace
furnace2 -.->|rdf:type| pmd_furnace
mold -.->|rdf:type| pmd_mold
bronze_formation -->|has_part| melting_cu
bronze_formation -->|has_part| melting_tin
bronze_formation -->|has_part| mixing
bronze_formation -->|has_part| solid
bronze_formation -->|starts_with| melting_cu
bronze_formation -->|ends_with| solid
melting_cu -->|has_specified_input| cu_t1
melting_cu -->|has_specified_output| cu_t2
melting_cu -->|has_participant| furnace1
melting_cu -->|precedes| mixing
melting_tin -->|has_specified_input| tin_t1
melting_tin -->|has_specified_output| tin_t3
melting_tin -->|has_participant| furnace2
melting_tin -->|precedes| mixing
mixing -->|has_specified_input| cu_t2
mixing -->|has_specified_input| tin_t3
mixing -->|has_specified_output| bronze_t4
mixing -->|has_participant| mold
mixing -->|precedes| solid
solid -->|has_specified_input| bronze_t4
solid -->|has_specified_output| bronze_t5
solid -->|has_participant| mold
cu_t1 -->|is_state_of| some_cu
cu_t2 -->|is_state_of| some_cu
tin_t1 -->|is_state_of| some_tin
tin_t3 -->|is_state_of| some_tin
bronze_t4 -->|is_state_of| some_bronze
bronze_t5 -->|is_state_of| some_bronze
classDef bfo fill:#b34dff,stroke:#7c3aed,stroke-width:2px,color:#fff;
classDef obi fill:#a78bbc,stroke:#7c5c8f,stroke-width:2px,color:#fff;
classDef pmd fill:#6b7fa3,stroke:#4a5568,stroke-width:2px,color:#fff;
classDef ind fill:#e8f0ff,stroke:#1e40af,stroke-width:2px,color:#0b1220;
class bfo_process bfo;
class obi_planned obi;
class pmd_manufacturing,pmd_melting,pmd_mixing,pmd_solidification,pmd_copper,pmd_tin,pmd_bronze,pmd_furnace,pmd_mold,pmd_agg_state pmd;
class bronze_formation,melting_cu,melting_tin,mixing,solid,some_cu,some_tin,cu_t1,cu_t2,tin_t1,tin_t3,bronze_t4,bronze_t5,some_bronze,furnace1,furnace2,mold ind;
style TBOX fill:transparent,stroke:transparent;
style ABOX fill:transparent,stroke:transparent;`,

            "fraction-shacl": `flowchart BT
subgraph SHAPES[" "]
direction BT
  shape_fraction["shape:fraction_value_specification"]
  constraint_numeric["sh:property (numeric value)"]
  constraint_unit["sh:property (unit)"]
  constraint_specifies["sh:property (specifies value of)"]
end
subgraph TARGETS[" "]
direction BT
  pmd_fraction["pmd:fraction_value_specification"]
  obi_numeric_value["obi:has_specified_numeric_value"]
  iao_unit["iao:has_measurement_unit_label"]
  obi_specifies["obi:specifies_value_of"]
  bfo_entity["bfo:entity"]
end
subgraph ALLOWED_UNITS[" "]
direction BT
  uo_mass_pct["uo:mass_percentage"]
  uo_vol_pct["uo:volume_percentage"]
  uo_mole_frac["uo:mole_fraction"]
end
shape_fraction -->|sh:targetClass| pmd_fraction
shape_fraction -->|sh:property| constraint_numeric
shape_fraction -->|sh:property| constraint_unit
shape_fraction -->|sh:property| constraint_specifies
constraint_numeric -->|sh:path| obi_numeric_value
constraint_numeric -->|"sh:minCount 1, sh:maxCount 1"| constraint_numeric
constraint_numeric -->|"sh:maxInclusive 100"| constraint_numeric
constraint_numeric -->|"sh:datatype xsd:float"| constraint_numeric
constraint_unit -->|sh:path| iao_unit
constraint_unit -->|sh:in| uo_mass_pct
constraint_unit -->|sh:in| uo_vol_pct
constraint_unit -->|sh:in| uo_mole_frac
constraint_specifies -->|sh:path| obi_specifies
constraint_specifies -->|sh:class| bfo_entity
classDef shacl fill:#22d3ee,stroke:#0891b2,stroke-width:2px,color:#042f2e;
classDef constraint fill:#fb923c,stroke:#ea580c,stroke-width:2px,color:#431407;
classDef obi fill:#a78bbc,stroke:#7c5c8f,stroke-width:2px,color:#fff;
classDef pmd fill:#6b7fa3,stroke:#4a5568,stroke-width:2px,color:#fff;
classDef bfo fill:#b34dff,stroke:#7c3aed,stroke-width:2px,color:#fff;
class shape_fraction shacl;
class constraint_numeric,constraint_unit,constraint_specifies constraint;
class obi_numeric_value,iao_unit,obi_specifies obi;
class pmd_fraction pmd;
class bfo_entity bfo;
class uo_mass_pct,uo_vol_pct,uo_mole_frac obi;
style SHAPES fill:transparent,stroke:transparent;
style TARGETS fill:transparent,stroke:transparent;
style ALLOWED_UNITS fill:transparent,stroke:transparent;`,

            "device-shacl": `flowchart BT
subgraph SHAPES[" "]
direction BT
  shape_device["ex:Shape6 (Device)"]
  shape_identifier["ex:Shape6_identifier"]
  shape_symbol["ex:Shape6_symbol"]
end
subgraph CONSTRAINTS[" "]
direction BT
  constraint_id_denoted["sh:property (denoted by identifier)"]
  constraint_id_value["sh:property (has specified value)"]
  constraint_sym_denoted["sh:property (denoted by symbol)"]
  constraint_sym_value["sh:property (has specified value)"]
end
subgraph CLASSES[" "]
direction BT
  obi_device["obi:device"]
  iao_identifier["iao:identifier"]
  iao_symbol["iao:symbol"]
  obi_value_spec["obi:value_specification"]
end
shape_device -->|sh:targetClass| obi_device
shape_device -->|"sh:or"| shape_identifier
shape_device -->|"sh:or"| shape_symbol
shape_identifier -->|sh:property| constraint_id_denoted
shape_identifier -->|sh:property| constraint_id_value
constraint_id_denoted -->|"sh:path iao:denoted_by"| iao_identifier
constraint_id_denoted -->|"sh:qualifiedMinCount 1"| constraint_id_denoted
constraint_id_value -->|"sh:path (denoted_by / has_value_spec / has_value)"| obi_value_spec
shape_symbol -->|sh:property| constraint_sym_denoted
shape_symbol -->|sh:property| constraint_sym_value
constraint_sym_denoted -->|"sh:path iao:denoted_by"| iao_symbol
constraint_sym_denoted -->|"sh:qualifiedMinCount 1"| constraint_sym_denoted
constraint_sym_value -->|"sh:path (denoted_by / has_value_spec / has_value)"| obi_value_spec
classDef shacl fill:#22d3ee,stroke:#0891b2,stroke-width:2px,color:#042f2e;
classDef constraint fill:#fb923c,stroke:#ea580c,stroke-width:2px,color:#431407;
classDef obi fill:#a78bbc,stroke:#7c5c8f,stroke-width:2px,color:#fff;
class shape_device,shape_identifier,shape_symbol shacl;
class constraint_id_denoted,constraint_id_value,constraint_sym_denoted,constraint_sym_value constraint;
class obi_device,iao_identifier,iao_symbol,obi_value_spec obi;
style SHAPES fill:transparent,stroke:transparent;
style CONSTRAINTS fill:transparent,stroke:transparent;
style CLASSES fill:transparent,stroke:transparent;`
        };

        // ========== NODE DATA FOR POPOVERS ==========
        const nodeData = {
            "temporal-region": {
                "bfo_occurrent": { label: "bfo:occurrent", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000003" },
                "bfo_process": { label: "bfo:process", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000015" },
                "bfo_continuant": { label: "bfo:continuant", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000002" },
                "bfo_temporal_region": { label: "bfo:temporal_region", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000008" },
                "bfo_1dtr": { label: "bfo:1D_temporal_region", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000038" },
                "bfo_0dtr": { label: "bfo:0D_temporal_region", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000148" },
                "ex_process_1": { label: "ex:process_1", type: "Individual", uri: "https://www.example.org/process_1" },
                "ex_process_2": { label: "ex:process_2", type: "Individual", uri: "https://www.example.org/process_2" },
                "ex_period_1": { label: "ex:period_1", type: "Individual", uri: "https://www.example.org/period_1" },
                "ex_period_2": { label: "ex:period_2", type: "Individual", uri: "https://www.example.org/period_2" },
                "ex_some_time": { label: "ex:some_time", type: "Individual", uri: "https://www.example.org/some_time" },
                "ex_object_1": { label: "ex:object_1", type: "Individual", uri: "https://www.example.org/object_1" },
                "ex_start": { label: "ex:start", type: "Individual", uri: "https://www.example.org/start" },
                "ex_end": { label: "ex:end", type: "Individual", uri: "https://www.example.org/end" }
            },
            "process-chain": {
                "bfo_process": { label: "bfo:process", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000015" },
                "ex_process_parent": { label: "ex:process_parent", type: "Individual", uri: "https://www.example.org/process_parent" },
                "ex_process_step1": { label: "ex:process_step1", type: "Individual", uri: "https://www.example.org/process_step1" },
                "ex_process_step2a": { label: "ex:process_step2a", type: "Individual", uri: "https://www.example.org/process_step2a" },
                "ex_process_step2b": { label: "ex:process_step2b", type: "Individual", uri: "https://www.example.org/process_step2b" },
                "ex_process_step3": { label: "ex:process_step3", type: "Individual", uri: "https://www.example.org/process_step3" }
            },
            "process-io": {
                "obi_planned_process": { label: "obi:planned_process", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0000011" },
                "pmd_manufacturing": { label: "pmd:manufacturing_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000833" },
                "pmd_coating": { label: "pmd:coating", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000563" },
                "bfo_object": { label: "bfo:object", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000030" },
                "ex_process1": { label: "ex:process1", type: "Individual", uri: "http://example.com/process1" },
                "ex_process2": { label: "ex:process2", type: "Individual", uri: "http://example.com/process2" },
                "ex_object1": { label: "ex:object1", type: "Individual", uri: "http://example.com/object1" },
                "ex_object2": { label: "ex:object2", type: "Individual", uri: "http://example.com/object2" },
                "ex_object3": { label: "ex:object3", type: "Individual", uri: "http://example.com/object3" }
            },
            "role-pattern": {
                "bfo_object": { label: "bfo:object", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000030" },
                "obi_evaluant_role": { label: "obi:evaluant_role", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0000067" },
                "pmd_fatigue_testing": { label: "pmd:fatigue_testing_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000638" },
                "ex_process_1": { label: "ex:process_1", type: "Individual", uri: "http://example.com/process_1" },
                "ex_object_1": { label: "ex:object_1", type: "Individual", uri: "http://example.com/object_1" },
                "ex_role_1": { label: "ex:role_1", type: "Individual", uri: "http://example.com/role_1" },
                "ex_objective_1": { label: "ex:objective_1", type: "Individual", uri: "http://example.com/objective_1" },
                "ex_result_1": { label: "ex:result_1", type: "Individual", uri: "http://example.com/result_1" }
            },
            "measurement": {
                "obi_assay": { label: "obi:assay", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0000070" },
                "obi_evaluant_role": { label: "obi:evaluant_role", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0000067" },
                "bfo_quality": { label: "bfo:quality", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000019" },
                "bfo_material_entity": { label: "bfo:material_entity", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000040" },
                "iao_scalar_datum": { label: "iao:scalar_measurement_datum", type: "Class", uri: "http://purl.obolibrary.org/obo/IAO_0000032" },
                "my_assay": { label: "my_assay", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_assay" },
                "my_evaluant_role": { label: "my_evaluant_role", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_entities_evaluant_role" },
                "my_quality": { label: "my_quality", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_entities_quality" },
                "my_entity": { label: "my_evaluated_entity", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_evaluated_entity" },
                "my_datum": { label: "my_measurement_datum", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_qualities_measurement_datum" },
                "my_value_spec": { label: "my_value_specification", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_measurment_datums_value_specification" },
                "my_objective": { label: "my_objective", type: "Individual", uri: "https://w3id.org/pmd/co/test/shape3/my_objective" }
            },
            "material-properties": {
                "bfo_object": { label: "bfo:object", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000030" },
                "pmd_material": { label: "pmd:material", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000000" },
                "bfo_quality": { label: "bfo:quality", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000019" },
                "pmd_mass": { label: "pmd:mass", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0020133" },
                "pmd_density": { label: "pmd:density", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000597" },
                "pmd_melting_point": { label: "pmd:melting_point", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000851" },
                "pmd_melting_process": { label: "pmd:melting_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000053" },
                "obi_svs": { label: "obi:scalar_value_specification", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0001931" },
                "ex_metal_sheet": { label: "ex:metal_sheet", type: "Individual", uri: "https://www.example.org/metal_sheet" },
                "ex_mass_metal_sheet": { label: "ex:mass_metal_sheet", type: "Individual", uri: "https://www.example.org/mass_metal_sheet" },
                "ex_svs_3_3_g": { label: "ex:svs_3.3g", type: "Individual", uri: "https://www.example.org/svs_3_3_g" },
                "ex_steel_material": { label: "ex:steel_material", type: "Individual", uri: "https://www.example.org/steel_material" },
                "ex_density_steel": { label: "ex:density_steel", type: "Individual", uri: "https://www.example.org/density_steel" },
                "ex_melting_temp": { label: "ex:melting_temperature", type: "Individual", uri: "https://www.example.org/melting_temperature_steel" },
                "ex_melting_process": { label: "ex:melting_process", type: "Individual", uri: "https://www.example.org/melting_process" }
            },
            "scalar-value": {
                "obi_svs": { label: "obi:scalar_value_specification", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0001931" },
                "iao_unit": { label: "iao:measurement_unit_label", type: "Class", uri: "http://purl.obolibrary.org/obo/IAO_0000003" },
                "ex_svs_x": { label: "ex:scalar_value_specification_X", type: "Individual", uri: "https://www.example.org/scalar_value_specification_X" },
                "ex_unit_x": { label: "ex:unit_X", type: "Individual", uri: "https://www.example.org/unit_X" },
                "val_135": { label: "135.0", type: "Literal", uri: "" }
            },
            "categorical-value": {
                "pmd_material": { label: "pmd:material", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000000" },
                "pmd_melt": { label: "pmd:melt", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0020139" },
                "pmd_crystal_struct": { label: "pmd:crystal_structure", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000591" },
                "pmd_grain_struct": { label: "pmd:metallic_grain_structure", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0025003" },
                "pmd_aggregate_state": { label: "pmd:aggregate_state", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000512" },
                "cat_fcc": { label: "fcc (cubic face centered)", type: "Categorical", uri: "https://w3id.org/pmd/co/PMD_0020019" },
                "cat_ferrite": { label: "ferrite", type: "Categorical", uri: "https://w3id.org/pmd/co/PMD_0020100" },
                "cat_liquid": { label: "liquid", type: "Categorical", uri: "https://w3id.org/pmd/co/PMD_0020118" },
                "ex_fcc_material": { label: "ex:fcc_material", type: "Individual", uri: "http://www.example.org/fcc_material" },
                "ex_crystal_qual": { label: "ex:crystal_structure_quality", type: "Individual", uri: "http://www.example.org/crystal_structure_quality" },
                "ex_grain_qual": { label: "ex:grain_structure_quality", type: "Individual", uri: "http://www.example.org/grain_structure_quality" },
                "ex_steel_melt": { label: "ex:steel_melt", type: "Individual", uri: "http://www.example.org/steel_melt" },
                "ex_agg_state_qual": { label: "ex:aggregate_state_quality", type: "Individual", uri: "http://www.example.org/aggregate_state_quality" }
            },
            "simulation-io": {
                "iao_ice": { label: "iao:InformationContentEntity", type: "Class", uri: "http://purl.obolibrary.org/obo/IAO_0000030" },
                "num_class": { label: ":Number", type: "Class", uri: "http://example.org/division#Number" },
                "pmd_sim_process": { label: "pmd:SimulationProcess", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000933" },
                "div_process": { label: ":DivisionProcess", type: "Class", uri: "http://example.org/division#DivisionProcess" },
                "input_assign": { label: "pmd:InputAssignment", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000066" },
                "output_assign": { label: "pmd:OutputAssignment", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000067" },
                "num_assign": { label: ":NumeratorAssignment", type: "Class", uri: "http://example.org/division#NumeratorAssignment" },
                "denom_assign": { label: ":DenominatorAssignment", type: "Class", uri: "http://example.org/division#DenominatorAssignment" },
                "quot_assign": { label: ":QuotientAssignment", type: "Class", uri: "http://example.org/division#QuotientAssignment" },
                "num1": { label: ":num1 = 10", type: "Individual", uri: "http://example.org/division#num1" },
                "num2": { label: ":num2 = 2", type: "Individual", uri: "http://example.org/division#num2" },
                "quotient1": { label: ":quotient1 = 5", type: "Individual", uri: "http://example.org/division#quotient1" },
                "div1": { label: ":div1", type: "Individual", uri: "http://example.org/division#div1" },
                "numerator_assign": { label: ":numerator_assign", type: "Individual", uri: "http://example.org/division#numerator_assign" },
                "denominator_assign": { label: ":denominator_assign", type: "Individual", uri: "http://example.org/division#denominator_assign" },
                "quotient_assign_i": { label: ":quotient_assign", type: "Individual", uri: "http://example.org/division#quotient_assign" }
            },
            "bronze-alloy": {
                "bfo_process": { label: "bfo:process", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000015" },
                "obi_planned": { label: "obi:planned_process", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0000011" },
                "pmd_manufacturing": { label: "pmd:manufacturing_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000833" },
                "pmd_melting": { label: "pmd:melting_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000053" },
                "pmd_mixing": { label: "pmd:mixing_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000778" },
                "pmd_solidification": { label: "pmd:solidification_process", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000906" },
                "pmd_copper": { label: "pmd:portion_of_copper", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0020054" },
                "pmd_tin": { label: "pmd:portion_of_tin", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0020088" },
                "pmd_bronze": { label: "bronze_alloy", type: "Class", uri: "http://example.org/bronze" },
                "pmd_furnace": { label: "pmd:furnace", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000655" },
                "pmd_mold": { label: "pmd:mold_device", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000075" },
                "pmd_agg_state": { label: "pmd:aggregate_state", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0000512" },
                "bronze_formation": { label: ":bronze_alloy_formation", type: "Individual", uri: "https://w3id.org/pmd/co/test/bronze_alloy_formation" },
                "melting_cu": { label: ":melting_copper", type: "Individual", uri: "https://w3id.org/pmd/co/test/melting_copper" },
                "melting_tin": { label: ":melting_tin", type: "Individual", uri: "https://w3id.org/pmd/co/test/melting_tin" },
                "mixing": { label: ":mixing_melts", type: "Individual", uri: "https://w3id.org/pmd/co/test/mixing_melts" },
                "solid": { label: ":solidification", type: "Individual", uri: "https://w3id.org/pmd/co/test/solidification" },
                "some_cu": { label: ":some_cu", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_cu" },
                "some_tin": { label: ":some_tin", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_tin" },
                "cu_t1": { label: ":some_cu_at_t1", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_cu_at_t1" },
                "cu_t2": { label: ":some_cu_at_t2", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_cu_at_t2" },
                "tin_t1": { label: ":some_tin_at_t1", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_tin_at_t1" },
                "tin_t3": { label: ":some_tin_at_t3", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_tin_at_t3" },
                "bronze_t4": { label: ":bronze_at_t4", type: "Individual", uri: "https://w3id.org/pmd/co/test/bronze_at_t4" },
                "bronze_t5": { label: ":bronze_at_t5", type: "Individual", uri: "https://w3id.org/pmd/co/test/bronze_at_t5" },
                "some_bronze": { label: ":some_bronze", type: "Individual", uri: "https://w3id.org/pmd/co/test/some_bronze" },
                "furnace1": { label: ":furnace_1", type: "Individual", uri: "https://w3id.org/pmd/co/test/furnace_1" },
                "furnace2": { label: ":furnace_2", type: "Individual", uri: "https://w3id.org/pmd/co/test/furnace_2" },
                "mold": { label: ":mold", type: "Individual", uri: "https://w3id.org/pmd/co/test/mold" }
            },
            "fraction-shacl": {
                "shape_fraction": { label: "shape:fraction_value_specification", type: "SHACL Shape", uri: "https://w3id.org/pmd/co/shapes/fraction_value_specification" },
                "constraint_numeric": { label: "sh:property (numeric value)", type: "Constraint", uri: "" },
                "constraint_unit": { label: "sh:property (unit)", type: "Constraint", uri: "" },
                "constraint_specifies": { label: "sh:property (specifies value of)", type: "Constraint", uri: "" },
                "pmd_fraction": { label: "pmd:fraction_value_specification", type: "Class", uri: "https://w3id.org/pmd/co/PMD_0025997" },
                "obi_numeric_value": { label: "obi:has_specified_numeric_value", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0001937" },
                "iao_unit": { label: "iao:has_measurement_unit_label", type: "Class", uri: "http://purl.obolibrary.org/obo/IAO_0000039" },
                "obi_specifies": { label: "obi:specifies_value_of", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0001927" },
                "bfo_entity": { label: "bfo:entity", type: "Class", uri: "http://purl.obolibrary.org/obo/BFO_0000001" },
                "uo_mass_pct": { label: "uo:mass_percentage", type: "Class", uri: "http://purl.obolibrary.org/obo/UO_0000163" },
                "uo_vol_pct": { label: "uo:volume_percentage", type: "Class", uri: "http://purl.obolibrary.org/obo/UO_0000165" },
                "uo_mole_frac": { label: "uo:mole_fraction", type: "Class", uri: "http://purl.obolibrary.org/obo/UO_0000076" }
            },
            "device-shacl": {
                "shape_device": { label: "ex:Shape6 (Device)", type: "SHACL Shape", uri: "http://www.example.org/#Shape6" },
                "shape_identifier": { label: "ex:Shape6_identifier", type: "SHACL Shape", uri: "http://www.example.org/#Shape6_identifier" },
                "shape_symbol": { label: "ex:Shape6_symbol", type: "SHACL Shape", uri: "http://www.example.org/#Shape6_symbol" },
                "constraint_id_denoted": { label: "sh:property (denoted by identifier)", type: "Constraint", uri: "" },
                "constraint_id_value": { label: "sh:property (has specified value)", type: "Constraint", uri: "" },
                "constraint_sym_denoted": { label: "sh:property (denoted by symbol)", type: "Constraint", uri: "" },
                "constraint_sym_value": { label: "sh:property (has specified value)", type: "Constraint", uri: "" },
                "obi_device": { label: "obi:device", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0000968" },
                "iao_identifier": { label: "iao:identifier", type: "Class", uri: "http://purl.obolibrary.org/obo/IAO_0020000" },
                "iao_symbol": { label: "iao:symbol", type: "Class", uri: "http://purl.obolibrary.org/obo/IAO_0000028" },
                "obi_value_spec": { label: "obi:value_specification", type: "Class", uri: "http://purl.obolibrary.org/obo/OBI_0001933" }
            }
        };

        // ========== GRAPH VIEWER CLASS ==========
        class MermaidGraphViewer {
            constructor(containerId, diagramId, diagramCode, data) {
                this.container = document.getElementById(containerId);
                this.diagramId = diagramId;
                this.diagramCode = diagramCode;
                this.nodeData = data || {};
                this.scale = 1;
                this.tx = 0;
                this.ty = 0;
                this.drag = false;
                this.sx = 0;
                this.sy = 0;

                this.wrapper = this.container.querySelector('.graph-wrapper');
                this.viewport = this.container.querySelector('.graph-viewport');
                this.diagramEl = this.container.querySelector('.mermaid-diagram');
                this.zoomLevel = this.container.querySelector('.zoom-level');
                this.popover = document.getElementById('global-popover');
                this.toast = document.getElementById('global-toast');

                this.init();
            }

            async init() {
                try {
                    // Use a unique ID with random suffix to prevent Mermaid ID conflicts
                    const uniqueId = `${this.diagramId}-${Math.random().toString(36).substring(2, 9)}`;
                    const { svg } = await mermaid.render(uniqueId, this.diagramCode);
                    this.diagramEl.innerHTML = svg;
                    this.bindEvents();
                    setTimeout(() => this.fitView(), 100);
                } catch (e) {
                    console.error('Mermaid render error:', e);
                    this.diagramEl.innerHTML = `<div style="color: var(--color-error); padding: 20px;">Error rendering diagram: ${e.message}</div>`;
                }
            }

            update() {
                this.wrapper.style.transform = `translate(${this.tx}px, ${this.ty}px) scale(${this.scale})`;
                this.zoomLevel.textContent = `${Math.round(this.scale * 100)}%`;
            }

            zoomIn() {
                this.scale = Math.min(3, this.scale * 1.2);
                this.hidePop();
                this.update();
            }

            zoomOut() {
                this.scale = Math.max(0.2, this.scale / 1.2);
                this.hidePop();
                this.update();
            }

            resetView() {
                this.scale = 1;
                this.tx = 0;
                this.ty = 0;
                this.hidePop();
                this.update();
            }

            fitView() {
                const svg = this.diagramEl.querySelector('svg');
                if (!svg) return;
                const sr = svg.getBoundingClientRect();
                const wr = this.viewport.getBoundingClientRect();
                this.scale = Math.min(wr.width / sr.width, wr.height / sr.height, 1) * 0.85;
                this.tx = (wr.width - sr.width * this.scale) / 2;
                this.ty = (wr.height - sr.height * this.scale) / 2;
                this.hidePop();
                this.update();
            }

            showToast(msg) {
                this.toast.textContent = msg;
                this.toast.style.display = 'block';
                clearTimeout(this._toastTimeout);
                this._toastTimeout = setTimeout(() => this.toast.style.display = 'none', 1800);
            }

            async copyText(text) {
                try {
                    await navigator.clipboard.writeText(text);
                    this.showToast('Copied to clipboard');
                } catch {
                    this.showToast('Copy failed');
                }
            }

            getNodeId(g) {
                const title = g.querySelector('title')?.textContent?.trim();
                if (title) return title;
                const gid = g.getAttribute('id') || '';
                const match = gid.match(/flowchart-([a-zA-Z0-9_]+)-\d+/);
                return match ? match[1] : null;
            }

            showPop(nodeId, x, y) {
                const data = this.nodeData[nodeId];
                if (!data) {
                    this.popover.innerHTML = `<div class="pop-head">
                <button class="close-btn" onclick="document.getElementById('global-popover').classList.remove('visible')"></button>
                <div class="pop-title">${nodeId}</div>
                <div class="pop-uri">No additional data</div>
            </div>`;
                } else {
                    // Determine the category label based on type
                    let cat;
                    switch (data.type) {
                        case 'Class': cat = 'Class (TBox)'; break;
                        case 'Literal': cat = 'Literal'; break;
                        case 'Categorical': cat = 'Categorical Value'; break;
                        case 'SHACL Shape': cat = 'SHACL Shape'; break;
                        case 'Constraint': cat = 'SHACL Constraint'; break;
                        default: cat = 'Individual (ABox)';
                    }
                    this.popover.innerHTML = `<div class="pop-head">
                <button class="close-btn" onclick="document.getElementById('global-popover').classList.remove('visible')"></button>
                <div class="pop-title">${data.label}<span class="badge">${cat}</span></div>
                <div class="pop-uri">${data.uri || 'Literal value'}</div>
                <div class="pop-actions">
                    <button class="chip" data-copy="label"> Copy Label</button>
                    ${data.uri ? '<button class="chip" data-copy="uri"> Copy URI</button>' : ''}
                </div>
            </div>`;

                    this.popover.querySelector('[data-copy="label"]')?.addEventListener('click', () => this.copyText(data.label));
                    this.popover.querySelector('[data-copy="uri"]')?.addEventListener('click', () => this.copyText(data.uri));
                }

                this.popover.classList.add('visible');
                const pr = this.popover.getBoundingClientRect();
                this.popover.style.left = Math.max(10, Math.min(x + 10, window.innerWidth - pr.width - 10)) + 'px';
                this.popover.style.top = Math.max(10, Math.min(y + 10, window.innerHeight - pr.height - 10)) + 'px';
            }

            hidePop() {
                this.popover.classList.remove('visible');
                this.diagramEl.querySelectorAll('g.node.selected').forEach(n => n.classList.remove('selected'));
            }

            downloadSVG() {
                const svg = this.diagramEl.querySelector('svg');
                if (!svg) return this.showToast('SVG not ready');

                const clone = svg.cloneNode(true);
                clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');

                const svgText = new XMLSerializer().serializeToString(clone);
                const blob = new Blob([svgText], { type: 'image/svg+xml;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${this.diagramId}.svg`;
                a.click();
                URL.revokeObjectURL(url);
                this.showToast('Downloading SVG');
            }

            openFullscreen() {
                const svg = this.diagramEl.querySelector('svg');
                if (!svg) return this.showToast('Graph not ready');

                const overlay = document.getElementById('fullscreen-overlay');
                const wrapper = document.getElementById('fullscreen-wrapper');
                const title = document.getElementById('fullscreen-title');
                const viewport = document.getElementById('fullscreen-viewport');
                const zoomLevel = document.getElementById('fs-zoom-level');
                const closeBtn = document.getElementById('fullscreen-close');
                const zoomInBtn = document.getElementById('fs-zoom-in');
                const zoomOutBtn = document.getElementById('fs-zoom-out');

                // Clone the SVG
                const clone = svg.cloneNode(true);
                wrapper.innerHTML = '';
                wrapper.appendChild(clone);

                // Set title
                const graphTitle = this.container.querySelector('.graph-title');
                title.textContent = graphTitle ? graphTitle.textContent : 'Graph View';

                // Fullscreen state
                let fsScale = 1, fsTx = 0, fsTy = 0, fsDrag = false, fsSx = 0, fsSy = 0;

                const updateFs = () => {
                    wrapper.style.transform = `translate(${fsTx}px, ${fsTy}px) scale(${fsScale})`;
                    zoomLevel.textContent = `${Math.round(fsScale * 100)}%`;
                };

                const fitFs = () => {
                    const sr = clone.getBoundingClientRect();
                    const vr = viewport.getBoundingClientRect();
                    fsScale = Math.min(vr.width / sr.width, vr.height / sr.height, 2) * 0.9;
                    fsTx = (vr.width - sr.width * fsScale) / 2;
                    fsTy = (vr.height - sr.height * fsScale) / 2;
                    updateFs();
                };

                // Event handlers
                const onZoomIn = () => { fsScale = Math.min(5, fsScale * 1.2); updateFs(); };
                const onZoomOut = () => { fsScale = Math.max(0.1, fsScale / 1.2); updateFs(); };

                const onWheel = (e) => {
                    e.preventDefault();
                    const ns = Math.max(0.1, Math.min(5, fsScale * (e.deltaY > 0 ? 0.9 : 1.1)));
                    const r = viewport.getBoundingClientRect();
                    const mx = e.clientX - r.left;
                    const my = e.clientY - r.top;
                    const sd = ns - fsScale;
                    fsTx -= (mx - fsTx) * (sd / fsScale);
                    fsTy -= (my - fsTy) * (sd / fsScale);
                    fsScale = ns;
                    updateFs();
                };

                const onMouseDown = (e) => {
                    fsDrag = true;
                    fsSx = e.clientX - fsTx;
                    fsSy = e.clientY - fsTy;
                };

                const onMouseMove = (e) => {
                    if (!fsDrag) return;
                    fsTx = e.clientX - fsSx;
                    fsTy = e.clientY - fsSy;
                    updateFs();
                };

                const onMouseUp = () => { fsDrag = false; };

                const onKeyDown = (e) => {
                    if (e.key === 'Escape') closeFullscreen();
                };

                const closeFullscreen = () => {
                    overlay.classList.remove('active');
                    document.body.style.overflow = '';
                    // Cleanup
                    zoomInBtn.removeEventListener('click', onZoomIn);
                    zoomOutBtn.removeEventListener('click', onZoomOut);
                    viewport.removeEventListener('wheel', onWheel);
                    viewport.removeEventListener('mousedown', onMouseDown);
                    window.removeEventListener('mousemove', onMouseMove);
                    window.removeEventListener('mouseup', onMouseUp);
                    window.removeEventListener('keydown', onKeyDown);
                    closeBtn.removeEventListener('click', closeFullscreen);
                };

                // Bind events
                zoomInBtn.addEventListener('click', onZoomIn);
                zoomOutBtn.addEventListener('click', onZoomOut);
                viewport.addEventListener('wheel', onWheel, { passive: false });
                viewport.addEventListener('mousedown', onMouseDown);
                window.addEventListener('mousemove', onMouseMove);
                window.addEventListener('mouseup', onMouseUp);
                window.addEventListener('keydown', onKeyDown);
                closeBtn.addEventListener('click', closeFullscreen);

                // Show overlay and fit
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
                setTimeout(fitFs, 50);
            }

            bindEvents() {
                // Zoom controls
                this.container.querySelectorAll('.zoom-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.dataset.action;
                        if (action === 'zoom-in') this.zoomIn();
                        if (action === 'zoom-out') this.zoomOut();
                    });
                });

                // Header controls
                this.container.querySelectorAll('.graph-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.dataset.action;
                        if (action === 'fit') this.fitView();
                        if (action === 'reset') this.resetView();
                        if (action === 'svg') this.downloadSVG();
                        if (action === 'fullscreen') this.openFullscreen();
                    });
                });

                // Mouse wheel zoom
                this.viewport.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const ns = Math.max(0.2, Math.min(3, this.scale * (e.deltaY > 0 ? 0.9 : 1.1)));
                    const r = this.viewport.getBoundingClientRect();
                    const mx = e.clientX - r.left;
                    const my = e.clientY - r.top;
                    const sd = ns - this.scale;
                    this.tx -= (mx - this.tx) * (sd / this.scale);
                    this.ty -= (my - this.ty) * (sd / this.scale);
                    this.scale = ns;
                    this.hidePop();
                    this.update();
                }, { passive: false });

                // Pan
                this.viewport.addEventListener('mousedown', (e) => {
                    if (e.target.closest('g.node')) return;
                    this.drag = true;
                    this.sx = e.clientX - this.tx;
                    this.sy = e.clientY - this.ty;
                    this.hidePop();
                });

                window.addEventListener('mousemove', (e) => {
                    if (!this.drag) return;
                    this.tx = e.clientX - this.sx;
                    this.ty = e.clientY - this.sy;
                    this.update();
                });

                window.addEventListener('mouseup', () => {
                    this.drag = false;
                });

                // Node interactions
                this.diagramEl.addEventListener('click', (e) => {
                    const node = e.target.closest('g.node');
                    if (node) {
                        const id = this.getNodeId(node);
                        if (id) {
                            this.diagramEl.querySelectorAll('g.node.selected').forEach(n => n.classList.remove('selected'));
                            node.classList.add('selected');
                            this.showPop(id, e.clientX, e.clientY);
                        }
                        e.stopPropagation();
                    } else {
                        this.hidePop();
                    }
                });

                // Hover effects
                this.diagramEl.addEventListener('mouseover', (e) => {
                    const node = e.target.closest('g.node');
                    if (node) {
                        node.classList.add('hovered');
                    }
                });

                this.diagramEl.addEventListener('mouseout', (e) => {
                    const node = e.target.closest('g.node');
                    if (node) {
                        node.classList.remove('hovered');
                    }
                });
            }
        }

        /* =====================================================
           MERMAID INITIALIZATION
           =====================================================
           
           OVERVIEW:
           Configures Mermaid.js library for rendering semantic web diagrams.
           
           KEY CONFIGURATIONS:
           - startOnLoad: false - We manually render diagrams for better control
           - securityLevel: 'loose' - Allows HTML labels in nodes
           - flowchart.useMaxWidth: false - Prevents auto-sizing for zoom/pan
           - theme: Syncs with current light/dark mode
           - themeVariables: Custom colors for nodes, edges, and labels
           
           IMPORTANT:
           - lineColor determines edge/arrow colors (overridden by CSS for reliability)
           - edgeLabelBackground: transparent - Prevents white boxes around labels
           - primaryColor: #b34dff (purple) - Used for BFO ontology class nodes
           
           ===================================================== */

        // Returns the appropriate line color based on current theme
        // Light mode: dark gray (#1e293b) for visibility on white backgrounds
        // Dark mode: white (#ffffff) for visibility on dark backgrounds
        const getLineColor = () => document.body.classList.contains('theme-dark') ? '#ffffff' : '#1e293b';

        const initMermaid = () => {
            mermaid.initialize({
                startOnLoad: false,          // Manual rendering for better control
                securityLevel: 'loose',       // Allow HTML labels in nodes
                flowchart: {
                    useMaxWidth: false,       // Disable auto-sizing for zoom/pan functionality
                    htmlLabels: true,         // Enable HTML formatting in node labels
                    curve: 'basis'            // Smooth curved edges between nodes
                },
                theme: document.body.classList.contains('theme-dark') ? 'dark' : 'default',
                themeVariables: {
                    primaryColor: '#b34dff',           // BFO class nodes (purple)
                    primaryTextColor: '#fff',          // Text on primary colored nodes
                    primaryBorderColor: '#4a148c',     // Border for primary nodes
                    lineColor: getLineColor(),         // Edge/arrow color (theme-dependent)
                    edgeLabelBackground: 'transparent', // No background on edge labels
                    secondaryColor: '#e8f0ff',         // Secondary node color
                    tertiaryColor: '#132743'           // Tertiary/subgraph background
                }
            });
        };
        initMermaid();

        // Create viewers for each diagram sequentially to avoid render conflicts
        async function initAllDiagrams() {
            const viewers = {};
            const entries = Object.entries(diagrams);

            for (const [id, code] of entries) {
                const containerId = `graph-${id}`;
                const diagramId = `diagram-${id}`;
                const data = nodeData[id] || {};
                viewers[id] = new MermaidGraphViewer(containerId, diagramId, code, data);
                // Small delay between initializations to prevent race conditions
                await new Promise(resolve => setTimeout(resolve, 50));
            }

            return viewers;
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAllDiagrams);
        } else {
            initAllDiagrams();
        }

        // Close popover on escape
        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('global-popover').classList.remove('visible');
            }
        });
    </script>

    <script>
        // ========== SITE UX (SIDEBAR, THEME, TOC) ==========
        (() => {
            const $ = (s, e = document) => e.querySelector(s);
            const $$ = (s, e = document) => Array.from(e.querySelectorAll(s));

            // Mobile sidebar
            const menuBtn = $('.mobile-menu-btn');
            const sidebar = $('.sidebar');
            const overlay = $('.sidebar-overlay');

            const closeSidebar = () => {
                sidebar?.classList.remove('open');
                overlay?.classList.remove('active');
                document.body?.classList.remove('no-scroll');
            };

            const openSidebar = () => {
                sidebar?.classList.add('open');
                overlay?.classList.add('active');
                document.body?.classList.add('no-scroll');
            };

            if (menuBtn && sidebar && overlay) {
                menuBtn.addEventListener('click', () => {
                    sidebar.classList.contains('open') ? closeSidebar() : openSidebar();
                });
                overlay.addEventListener('click', closeSidebar);
                window.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') closeSidebar();
                });
            }

            // Theme toggle
            const themeBtn = $('.theme-toggle');
            const themeLabel = $('.theme-label');
            const THEME_KEY = 'pmd_theme';

            const applyTheme = (t) => {
                if (t === 'dark') {
                    document.body.classList.add('theme-dark');
                    if (themeLabel) themeLabel.textContent = 'Dark';
                } else {
                    document.body.classList.remove('theme-dark');
                    if (themeLabel) themeLabel.textContent = 'Light';
                }
            };

            try {
                const saved = localStorage.getItem(THEME_KEY);
                if (saved) applyTheme(saved);
            } catch (_) { }

            if (themeBtn) {
                themeBtn.addEventListener('click', () => {
                    const isDark = document.body.classList.contains('theme-dark');
                    const next = isDark ? 'light' : 'dark';
                    applyTheme(next);
                    try { localStorage.setItem(THEME_KEY, next); } catch (_) { }
                });
            }

            // TOC active section highlight
            const tocEl = $('.toc');
            const content = $('.content');

            if (tocEl && content) {
                const links = $$('a[href^="#"]', tocEl);
                const byId = new Map();

                for (const a of links) {
                    const id = (a.getAttribute('href') || '').slice(1);
                    if (id) byId.set(id, a);
                }

                const headings = $$('h2[id], h3[id]', content).filter(h => byId.has(h.id));

                const clear = () => links.forEach(a => a.classList.remove('active'));
                const setActive = (id) => {
                    clear();
                    const a = byId.get(id);
                    if (a) a.classList.add('active');
                };

                if ('IntersectionObserver' in window && headings.length) {
                    let currentActive = null;

                    const updateActiveOnScroll = () => {
                        const scrollY = window.scrollY + 120;
                        let found = null;

                        for (let i = headings.length - 1; i >= 0; i--) {
                            const h = headings[i];
                            if (h.offsetTop <= scrollY) {
                                found = h.id;
                                break;
                            }
                        }

                        if (!found && headings.length > 0) {
                            found = headings[0].id;
                        }

                        if (found !== currentActive) {
                            currentActive = found;
                            setActive(found);
                        }
                    };

                    window.addEventListener('scroll', updateActiveOnScroll, { passive: true });
                    updateActiveOnScroll();
                }
            }
        })();

        /* Search */
        class Search {
            constructor() {
                this.selectedIndex = -1;
                this.searchIndex = this.buildSearchIndex();
                this.createModal();
                this.bindEvents();
            }

            buildSearchIndex() {
                const pages = [
                    { title: 'Home', path: './index.html', section: 'Getting Started', keywords: ['home', 'start', 'overview', 'pmdco', 'documentation'] },
                    { title: 'Introduction', path: './intro.html', section: 'Getting Started', keywords: ['intro', 'introduction', 'getting started', 'overview'] },
                    { title: 'Background', path: './background-and-context.html', section: 'Getting Started', keywords: ['background', 'context', 'history', 'motivation'] },
                    { title: 'Ontologies Intro', path: './introduction-to-ontologies.html', section: 'Getting Started', keywords: ['ontology', 'ontologies', 'introduction', 'basics', 'owl', 'rdf'] },
                    { title: 'Structure', path: './ontology-structure.html', section: 'Ontology Guide', keywords: ['structure', 'architecture', 'classes', 'properties', 'hierarchy'] },
                    { title: 'Usage Patterns', path: './patterns.html', section: 'Ontology Guide', keywords: ['patterns', 'usage', 'examples', 'best practices', 'modeling'] },
                    { title: 'User Guide', path: './user-guide.html', section: 'Ontology Guide', keywords: ['guide', 'user', 'tutorial', 'how to', 'instructions'] },
                    { title: 'Reused Ontologies', path: './reused-ontologies.html', section: 'Ontology Guide', keywords: ['reused', 'imported', 'external', 'bfo', 'iao', 'obi'] },
                    { title: 'Design', path: './design-and-methodology.html', section: 'Development', keywords: ['design', 'methodology', 'principles', 'approach'] },
                    { title: 'Formatting', path: './ontology-formatting.html', section: 'Development', keywords: ['formatting', 'style', 'conventions', 'syntax'] },
                    { title: 'Contributing', path: './contributing.html', section: 'Development', keywords: ['contributing', 'contribute', 'github', 'pull request'] },
                    { title: 'Migration', path: './migration.html', section: 'Development', keywords: ['migration', 'upgrade', 'version', 'changes'] },
                    { title: 'Glossary', path: './glossary-and-tools.html', section: 'Resources', keywords: ['glossary', 'terms', 'definitions', 'tools'] },
                    { title: 'Versions', path: './versions.html', section: 'Resources', keywords: ['versions', 'releases', 'changelog', 'history'] },
                    { title: 'Publications', path: './publications.html', section: 'Resources', keywords: ['publications', 'papers', 'research', 'citations'] },
                    { title: 'References', path: './references.html', section: 'Resources', keywords: ['references', 'bibliography', 'sources', 'links'] },
                    { title: 'Who We Are', path: './about-us.html', section: 'About', keywords: ['about', 'team', 'who', 'contact'] },
                    { title: 'Acknowledgements', path: './acknowledgements.html', section: 'About', keywords: ['acknowledgements', 'thanks', 'credits'] }
                ];

                const contentIndex = this.extractPageContent();
                return pages.map(page => ({ ...page, content: contentIndex[page.path] || [] }));
            }

            extractPageContent() {
                const content = {};
                document.querySelectorAll('h1, h2, h3, h4').forEach(heading => {
                    const id = heading.id || heading.textContent.trim().toLowerCase().replace(/\s+/g, '-');
                    const text = heading.textContent.trim();
                    const path = window.location.pathname.split('/').pop() || 'index.html';
                    if (!content['./' + path]) content['./' + path] = [];
                    content['./' + path].push({ type: 'heading', text, id, level: heading.tagName });
                });
                return content;
            }

            createModal() {
                const html = `<div class="search-modal" id="search-modal">
            <div class="search-modal-content">
                <div class="search-modal-header">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    <input type="text" class="search-modal-input" id="search-input" placeholder="Search documentation..." autocomplete="off">
                    <kbd class="search-shortcut">ESC</kbd>
                </div>
                <div class="search-results" id="search-results"><div class="search-no-results">Type to search...</div></div>
                <div class="search-footer"><span><kbd></kbd><kbd></kbd> Navigate</span><span><kbd></kbd> Open</span><span><kbd>ESC</kbd> Close</span></div>
            </div>
        </div>`;
                document.body.insertAdjacentHTML('beforeend', html);
                this.modal = document.getElementById('search-modal');
                this.input = document.getElementById('search-input');
                this.resultsContainer = document.getElementById('search-results');
            }

            bindEvents() {
                document.addEventListener('keydown', e => {
                    if ((e.ctrlKey || e.metaKey) && e.key === 'k') { e.preventDefault(); this.open(); }
                    if (e.key === 'Escape' && this.modal.classList.contains('active')) this.close();
                    if (this.modal.classList.contains('active')) {
                        if (e.key === 'ArrowDown') { e.preventDefault(); this.navigate(1); }
                        if (e.key === 'ArrowUp') { e.preventDefault(); this.navigate(-1); }
                        if (e.key === 'Enter') { e.preventDefault(); this.selectCurrent(); }
                    }
                });
                this.modal.addEventListener('click', e => { if (e.target === this.modal) this.close(); });
                document.querySelector('.search-input')?.addEventListener('click', e => { e.preventDefault(); this.open(); });
                this.input.addEventListener('input', () => { this.selectedIndex = -1; this.search(this.input.value); });
            }

            navigate(dir) {
                const items = this.resultsContainer.querySelectorAll('.search-result-item');
                if (!items.length) return;
                items[this.selectedIndex]?.classList.remove('selected');
                this.selectedIndex = Math.max(-1, Math.min(items.length - 1, this.selectedIndex + dir));
                if (this.selectedIndex === -1) this.selectedIndex = dir > 0 ? 0 : items.length - 1;
                items[this.selectedIndex]?.classList.add('selected');
                items[this.selectedIndex]?.scrollIntoView({ block: 'nearest' });
            }

            selectCurrent() {
                const items = this.resultsContainer.querySelectorAll('.search-result-item');
                if (this.selectedIndex >= 0 && items[this.selectedIndex]) {
                    const href = items[this.selectedIndex].getAttribute('href');
                    if (href.includes('#')) {
                        const [path, hash] = href.split('#');
                        const currentPath = window.location.pathname.split('/').pop() || 'index.html';
                        if (path === './' + currentPath || path === currentPath) {
                            this.close();
                            const el = document.getElementById(hash);
                            if (el) el.scrollIntoView({ behavior: 'instant', block: 'start' });
                            return;
                        }
                    }
                    window.location.href = href;
                }
            }

            search(query) {
                if (!query.trim()) {
                    this.resultsContainer.innerHTML = '<div class="search-no-results">Type to search...</div>';
                    return;
                }

                const q = query.toLowerCase();
                const results = [];

                this.searchIndex.forEach(page => {
                    let score = 0;
                    if (page.title.toLowerCase().includes(q)) score += 10;
                    if (page.keywords.some(k => k.includes(q))) score += 5;
                    page.content.forEach(item => {
                        if (item.text.toLowerCase().includes(q)) {
                            results.push({ ...page, anchor: item.id, anchorText: item.text, score: score + 3 });
                        }
                    });
                    if (score > 0) results.push({ ...page, score });
                });

                results.sort((a, b) => b.score - a.score);
                const unique = [];
                const seen = new Set();
                results.forEach(r => {
                    const key = r.path + (r.anchor || '');
                    if (!seen.has(key)) { seen.add(key); unique.push(r); }
                });

                if (!unique.length) {
                    this.resultsContainer.innerHTML = `<div class="search-no-results">No results for "${this.escapeHtml(query)}"</div>`;
                    return;
                }

                const grouped = {};
                unique.slice(0, 12).forEach(r => {
                    if (!grouped[r.section]) grouped[r.section] = [];
                    grouped[r.section].push(r);
                });

                let html = '';
                Object.entries(grouped).forEach(([section, items]) => {
                    html += `<div class="search-section-label">${section}</div>`;
                    items.forEach(item => {
                        const href = item.anchor ? `${item.path}#${item.anchor}` : item.path;
                        const title = item.anchorText || item.title;
                        html += `<a href="${href}" class="search-result-item">
                    <div class="search-result-title">${this.highlightMatches(title, query)}</div>
                    ${item.anchorText ? `<div class="search-result-path">${item.title}</div>` : ''}
                </a>`;
                    });
                });
                this.resultsContainer.innerHTML = html;
            }

            highlightMatches(text, query) {
                const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                return this.escapeHtml(text).replace(regex, '<mark>$1</mark>');
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            open() { this.modal.classList.add('active'); this.input.focus(); }
            close() { this.modal.classList.remove('active'); this.input.value = ''; this.selectedIndex = -1; this.resultsContainer.innerHTML = '<div class="search-no-results">Type to search...</div>'; }
        }

        /* Image Viewer */
        class ImageViewer {
            constructor() {
                this.scale = 1;
                this.translateX = 0;
                this.translateY = 0;
                this.isDragging = false;
                this.startX = 0;
                this.startY = 0;
                this.currentElement = null;
                this.createOverlay();
                this.bindEvents();
            }

            createOverlay() {
                const html = `
            <div class="image-viewer-overlay" id="image-viewer">
                <button class="image-viewer-close">&times;</button>
                <div class="image-viewer-container" id="image-viewer-container"></div>
                <div class="image-viewer-controls">
                    <button class="image-viewer-btn" id="zoom-in">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg>
                        Zoom In
                    </button>
                    <button class="image-viewer-btn" id="zoom-out">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="8" y1="11" x2="14" y2="11"/></svg>
                        Zoom Out
                    </button>
                    <button class="image-viewer-btn" id="zoom-reset">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
                        Reset
                    </button>
                    <button class="image-viewer-btn" id="download-png">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        Download PNG (600 DPI)
                    </button>
                </div>
            </div>`;
                document.body.insertAdjacentHTML('beforeend', html);
                this.overlay = document.getElementById('image-viewer');
                this.container = document.getElementById('image-viewer-container');
            }

            bindEvents() {
                document.querySelectorAll('.article-content img, .article-content svg, .viewable-image').forEach(el => {
                    el.style.cursor = 'zoom-in';
                    el.addEventListener('click', e => {
                        e.preventDefault();
                        this.open(el);
                    });
                });

                this.overlay.querySelector('.image-viewer-close').addEventListener('click', () => this.close());
                this.overlay.addEventListener('click', e => { if (e.target === this.overlay) this.close(); });
                document.getElementById('zoom-in').addEventListener('click', () => this.zoom(0.25));
                document.getElementById('zoom-out').addEventListener('click', () => this.zoom(-0.25));
                document.getElementById('zoom-reset').addEventListener('click', () => this.reset());
                document.getElementById('download-png').addEventListener('click', () => this.downloadPNG());

                this.container.addEventListener('wheel', e => {
                    e.preventDefault();
                    this.zoom(e.deltaY > 0 ? -0.1 : 0.1);
                });

                this.container.addEventListener('mousedown', e => {
                    this.isDragging = true;
                    this.startX = e.clientX - this.translateX;
                    this.startY = e.clientY - this.translateY;
                    this.container.style.cursor = 'grabbing';
                });

                document.addEventListener('mousemove', e => {
                    if (!this.isDragging) return;
                    this.translateX = e.clientX - this.startX;
                    this.translateY = e.clientY - this.startY;
                    this.updateTransform();
                });

                document.addEventListener('mouseup', () => {
                    this.isDragging = false;
                    this.container.style.cursor = 'grab';
                });

                document.addEventListener('keydown', e => {
                    if (!this.overlay.classList.contains('active')) return;
                    if (e.key === 'Escape') this.close();
                    if (e.key === '+' || e.key === '=') this.zoom(0.25);
                    if (e.key === '-') this.zoom(-0.25);
                    if (e.key === '0') this.reset();
                });
            }

            open(element) {
                this.currentElement = element;
                this.reset();

                if (element.tagName === 'IMG') {
                    const img = document.createElement('img');
                    img.src = element.src;
                    img.alt = element.alt || 'Image';
                    this.container.innerHTML = '';
                    this.container.appendChild(img);
                } else if (element.tagName === 'svg' || element.tagName === 'SVG') {
                    const clone = element.cloneNode(true);
                    clone.style.width = '80vw';
                    clone.style.height = 'auto';
                    clone.style.maxHeight = '85vh';
                    this.container.innerHTML = '';
                    this.container.appendChild(clone);
                }

                this.overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            close() {
                this.overlay.classList.remove('active');
                document.body.style.overflow = '';
            }

            zoom(delta) {
                this.scale = Math.max(0.5, Math.min(5, this.scale + delta));
                this.updateTransform();
            }

            reset() {
                this.scale = 1;
                this.translateX = 0;
                this.translateY = 0;
                this.updateTransform();
            }

            updateTransform() {
                const el = this.container.querySelector('img, svg');
                if (el) el.style.transform = `translate(${this.translateX}px, ${this.translateY}px) scale(${this.scale})`;
            }

            async downloadPNG() {
                const el = this.container.querySelector('img, svg');
                if (!el) return;

                const dpi = 600;
                const scaleFactor = dpi / 96;
                let canvas, ctx;

                if (el.tagName === 'IMG') {
                    const img = new Image();
                    img.crossOrigin = 'anonymous';
                    img.src = el.src;
                    await new Promise(resolve => img.onload = resolve);

                    canvas = document.createElement('canvas');
                    canvas.width = img.naturalWidth * scaleFactor;
                    canvas.height = img.naturalHeight * scaleFactor;
                    ctx = canvas.getContext('2d');
                    ctx.scale(scaleFactor, scaleFactor);
                    ctx.drawImage(img, 0, 0);
                } else {
                    const svgData = new XMLSerializer().serializeToString(el);
                    const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
                    const url = URL.createObjectURL(svgBlob);

                    const img = new Image();
                    img.src = url;
                    await new Promise(resolve => img.onload = resolve);

                    const width = el.viewBox?.baseVal?.width || el.getBoundingClientRect().width || 800;
                    const height = el.viewBox?.baseVal?.height || el.getBoundingClientRect().height || 600;

                    canvas = document.createElement('canvas');
                    canvas.width = width * scaleFactor;
                    canvas.height = height * scaleFactor;
                    ctx = canvas.getContext('2d');
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    ctx.scale(scaleFactor, scaleFactor);
                    ctx.drawImage(img, 0, 0, width, height);
                    URL.revokeObjectURL(url);
                }

                const link = document.createElement('a');
                link.download = 'pmdco-image-600dpi.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            }
        }

        // Initialize Search and ImageViewer
        new Search();
        new ImageViewer();
    </script>
</body>

</html>