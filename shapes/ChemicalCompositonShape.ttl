@prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix sh:    <http://www.w3.org/ns/shacl#> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs:  <http://www.w3.org/2000/01/rdf-schema#> .
@prefix ex:    <http://www.example.org/#> .
@prefix owl:   <http://www.w3.org/2002/07/owl#> .
@prefix pmd:   <https://w3id.org/pmd/co/> .
@prefix shape:   <https://w3id.org/pmd/co/shapes> .
@prefix obo: <http://purl.obolibrary.org/obo/> .


### Inspired by Copy of copy of Frame 28b
### Approach bottom up from values to the chemical composition
### TODO: chains of properties

pmd:ProportionShape 
    rdf:type sh:NodeShape ; 
    sh:targetClass pmd:PMD_0020101 ;  # proportion (mass, volume , molar)
    sh:property [
        sh:path obo:BFO_0000059 ; #concretizes
        sh:minCount 1 ; 
        sh:maxCount 1 ; 
        sh:node pmd:ScalarValueSpecificationShape ;
    ] ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type owl:topDataProperty owl:topObjectProperty ) .

pmd:PortionOfMatterShape
    rdf:type sh:NodeShape ; 
    sh:targetClass pmd:PMD_0020025 ; #pure substances under portion of matter
    sh:property [
        sh:path obo:BFO_0000196 ; #bearer of
        sh:node pmd:ProportionShape ;
    ] ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type owl:topDataProperty owl:topObjectProperty ) .

pmd:ChemicalCompositionSpecificationShape 
    rdf:type sh:NodeShape ; 
    sh:targetClass pmd:PMD_0020004 ; #chemical composition specification
    sh:property [
        sh:path obo:BFO_0000178 ; #has continious part
        sh:node pmd:ScalarValueSpecificationShape ; 
        sh:minCount 1 ;
    ] ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type owl:topDataProperty owl:topObjectProperty ) .

pmd:ChemicalCompositionShape
    rdf:type sh:NodeShape ; 
    sh:targetClass pmd:PMD_0000551 ; #chemical composition 
    sh:property [
        sh:path obo:BFO_0000059 ; #concretizes
        sh:node pmd:ChemicalCompositionSpecificationShape ;
        sh:minCount 1 ; 
        sh:maxCount 1 ; 
    ] ; 
    sh:closed true ;
    sh:ignoredProperties ( rdf:type owl:topDataProperty owl:topObjectProperty ) .

pmd:MaterialChemicalCompositionShape
    rdf:type sh:NodeShape ; 
    sh:targetClass pmd:PMD_0000000 ; #material
    sh:property [
        sh:path obo:BFO_0000196 ; #bearer of
        sh:node pmd:ChemicalCompositionShape ; 
        sh:minCount 1 ; 
        sh:maxCount 1 ; 
    ] ;
    sh:property [
        sh:path pmd:PMD_0020005 ; #consists of
        sh:node pmd:PortionOfMatterShape ; 
        sh:minCount 1 ; 
    ] ;
    sh:property [
        ## alternative paths between material and proportion
        sh:path obo:BFO_0000196 ; #bearer of
        sh:node pmd:ProportionShape ; 
        sh:minCount 1 ; 
        sh:path
        [
            sh:alternativePath 
            (
                obo:BFO_0000196 ## simple option: bearer of
                sh:sequencePath
                ( 
                    obo:BFO_0000196 
                    obo:BFO_0000059 
                    obo:BFO_0000178 
                    obo:BFO_0000058
                ) ## 2nd option: bearer of - concretizes - has continious part - is concretized by
                sh:sequencePath
                ( 
                    pmd:PMD_0020005
                    obo:BFO_0000196 
                ) ## 3rd option: consists of - bearer of
            ) 
        ] 
    ] ;
    # not closed shape because material has other properties
    sh:ignoredProperties ( rdf:type owl:topDataProperty owl:topObjectProperty ) .

pmd:SampleChemicalCompositonShape
    rdf:type sh:NodeShape ; 
    sh:targetClass obo:BFO_0000030 ; #object
    sh:property [
        sh:path pmd:PMD_0020005 ; #consists of
        sh:node pmd:MaterialChemicalCompositionShape ; 
        sh:mincount 1 ;
    ] ;
    # not closed shape because other objects features are to come
    sh:ignoredProperties ( rdf:type owl:topDataProperty owl:topObjectProperty ) .


